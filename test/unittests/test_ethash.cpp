// ethash: C/C++ implementation of Ethash, the Ethereum Proof of Work algorithm.
// Copyright 2018 Pawel Bylica.
// Licensed under the Apache License, Version 2.0.

/* abelethash: C/C++ implementation of AbelEthash, the Abelian Proof of Work algorithm.
 * Copyright 2022-2023 Abelian Foundation.
 * Licensed under the Apache License, Version 2.0.
 */


#pragma GCC diagnostic ignored "-Wpedantic"
#pragma clang diagnostic ignored "-Wpedantic"
#pragma warning(disable : 4127)

#include <ethash/endianness.hpp>
#include <ethash/ethash-internal.hpp>
#include <ethash/ethash.hpp>
#include <ethash/keccak.hpp>

#include "../experimental/difficulty.h"
#include "helpers.hpp"
#include "test_cases.hpp"

#include <gtest/gtest.h>

#include <array>
#include <future>

using namespace ethash;

namespace
{
struct test_context_full : epoch_context
{
    hash1024* full_dataset;
};

/// Creates the epoch context of the correct size but filled with fake data.
epoch_context_ptr create_epoch_context_mock(int epoch_number)
{
    // Prepare a constant endianness-independent cache item.
    hash512 fill;
    static constexpr uint64_t fill_word = 0xe14a54a1b2c3d4e5;
    std::fill_n(fill.word64s, sizeof(hash512) / sizeof(uint64_t), le::uint64(fill_word));

    static const size_t context_alloc_size = std::max(sizeof(epoch_context), sizeof(hash512));

    // The copy of ethash_create_epoch_context() but without light cache building:

    const int light_cache_num_items = calculate_light_cache_num_items(epoch_number);
    const size_t light_cache_size = get_light_cache_size(light_cache_num_items);
    const size_t alloc_size = context_alloc_size + light_cache_size;

    char* const alloc_data = static_cast<char*>(std::malloc(alloc_size));
    hash512* const light_cache = reinterpret_cast<hash512*>(alloc_data + context_alloc_size);
    std::fill_n(light_cache, light_cache_num_items, fill);

    epoch_context* const context = new (alloc_data) epoch_context{
        epoch_number,
        light_cache_num_items,
        light_cache,
        calculate_full_dataset_num_items(epoch_number),
    };
    return {context, ethash_destroy_epoch_context};
}

hash512 copy(const hash512& h) noexcept
{
    return h;
}
}  // namespace

TEST(ethash, revision)
{
//    static_assert(ethash::revision[0] == '2', "");
//    static_assert(ethash::revision[1] == '3', "");
//    EXPECT_EQ(ethash::revision, "23");
//    EXPECT_EQ(ethash::revision, (std::string{"23"}));

    static_assert(ethash::revision[0] == '1', "");
    EXPECT_EQ(ethash::revision, "1");
    EXPECT_EQ(ethash::revision, (std::string{"1"}));
}

TEST(ethash, error_code)
{
    std::ostringstream os;
    std::error_code ec = ETHASH_SUCCESS;
    EXPECT_FALSE(ec);
    EXPECT_EQ(ec.message(), "");

    ec = ETHASH_INVALID_FINAL_HASH;
    EXPECT_TRUE(ec);
    EXPECT_EQ(ec.message(), "invalid final hash");
    os.str({});
    os << ec;
    EXPECT_EQ(os.str(), "ethash:1");

    ec = ETHASH_INVALID_MIX_HASH;
    EXPECT_TRUE(ec);
    EXPECT_EQ(ec.message(), "invalid mix hash");
    os.str({});
    os << ec;
    EXPECT_EQ(os.str(), "ethash:2");

    ec = static_cast<ethash_errc>(3);
    EXPECT_TRUE(ec);
    EXPECT_EQ(ec.message(), "unknown error");
    os.str({});
    os << ec;
    EXPECT_EQ(os.str(), "ethash:3");
}

TEST(hash, hash256_from_bytes)
{
    const uint8_t bytes[32] = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
        20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31};
    auto h = hash256_from_bytes(bytes);
    EXPECT_EQ(to_hex(h), "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f");
}

TEST(hash, hash512_init)
{
    hash512 hash = {};
    for (auto w : hash.word64s)
        EXPECT_EQ(w, 0);

    hash512 hash2 = copy({});
    for (auto w : hash2.word64s)
        EXPECT_EQ(w, 0);
}

TEST(hash, hash1024_init)
{
    hash1024 hash = {};
    for (auto w : hash.word64s)
        EXPECT_EQ(w, 0);
}

struct dataset_size_test_case
{
    int epoch_number;
    uint64_t light_cache_size;
    uint64_t full_dataset_size;
};

/// Test cases for dataset sizes are random picked from generated ethash sizes.
/// See https://github.com/ethereum/wiki/wiki/Ethash#data-sizes.
/*static dataset_size_test_case dataset_size_test_cases[] = {
    {0, 16776896, 1073739904},
    {14, 18611392, 1191180416},
    {17, 19004224, 1216345216},
    {56, 24116672, 1543503488},
    {158, 37486528, 2399139968},
    {203, 43382848, 2776625536},
    {211, 44433344, 2843734144},
    {272, 52427968, 3355440512},
    {350, 62651584, 4009751168},
    {412, 70778816, 4529846144},
    {464, 77593664, 4966054784},
    {530, 86244416, 5519703424},
    {656, 102760384, 6576662912},
    {657, 102890432, 6585055616},
    {658, 103021888, 6593443456},
    {739, 113639104, 7272921472},
    {751, 115212224, 7373585792},
    {798, 121372352, 7767849088},
    {810, 122945344, 7868512384},
    {862, 129760832, 8304715136},
    {882, 132382528, 8472492928},
    {920, 137363392, 8791260032},
    {977, 144832448, 9269411456},
    {1093, 160038464, 10242489472},
    {1096, 160430656, 10267656064},
    {1119, 163446592, 10460589952},
    {1125, 164233024, 10510923392},
    {1165, 169475648, 10846469248},
    {1168, 169866304, 10871631488},
    {1174, 170655424, 10921964672},
    {1211, 175504832, 11232345728},
    {1244, 179830208, 11509169024},
    {1410, 201588544, 12901672832},
    {1418, 202636352, 12968786816},
    {1436, 204996544, 13119782528},
    {1502, 213645632, 13673430656},
    {1512, 214956992, 13757316224},
    {1535, 217972672, 13950253696},
    {1538, 218364736, 13975417216},
    {1554, 220461632, 14109635968},
    {1571, 222690368, 14252243072},
    {1602, 226754368, 14512291712},
    {1621, 229243328, 14671675264},
    {1630, 230424512, 14747172736},
    {1698, 239335232, 15317596544},
    {1746, 245628736, 15720251264},
    {1790, 251395136, 16089346688},
    {1818, 255065792, 16324230016},
    {1912, 267386432, 17112759424},
    {1928, 269482688, 17246976896},
    {1956, 273153856, 17481857408},
    {2047, 285081536, 18245220736},
    {30000, 3948936512, 252731976832},
    {max_epoch_number, 4294836032, 274'869'514'624},
    {max_epoch_number + 1, 0, 0},
    {max_epoch_number * 2, 0, 0},
    {-1, 0, 0},
};*/

static dataset_size_test_case dataset_size_test_cases[] = {
    { 0 , 16776896 , 1073739904 },
    { 1 , 25165376 , 1610610304 },
    { 2 , 33554368 , 2147483264 },
    { 3 , 41942848 , 2684352896 },
    { 4 , 50331584 , 3221224064 },
    { 5 , 58720192 , 3758091136 },
    { 6 , 67108672 , 4294962304 },
    { 7 , 75497024 , 4831835776 },
    { 8 , 83886016 , 5368706944 },
    { 9 , 84147776 , 5385484928 },
    { 10 , 84409792 , 5402263424 },
    { 11 , 84672064 , 5419040384 },
    { 12 , 84934336 , 5435816576 },
    { 13 , 85193792 , 5452594816 },
    { 14 , 85458496 , 5469367936 },
    { 15 , 85721024 , 5486148736 },
    { 16 , 85982656 , 5502925952 },
    { 17 , 86244416 , 5519703424 },
    { 18 , 86506688 , 5536481152 },
    { 19 , 86769344 , 5553256064 },
    { 20 , 87031744 , 5570032768 },
    { 21 , 87293632 , 5586811264 },
    { 22 , 87555392 , 5603585408 },
    { 23 , 87816896 , 5620366208 },
    { 24 , 88079168 , 5637143936 },
    { 25 , 88341824 , 5653921408 },
    { 26 , 88603712 , 5670694784 },
    { 27 , 88862912 , 5687474048 },
    { 28 , 89128384 , 5704251008 },
    { 29 , 89390272 , 5721030272 },
    { 30 , 89652544 , 5737806208 },
    { 31 , 89914816 , 5754583936 },
    { 32 , 90177088 , 5771358592 },
    { 33 , 90438848 , 5788137856 },
    { 34 , 90700096 , 5804911232 },
    { 35 , 90963776 , 5821692544 },
    { 36 , 91223744 , 5838468992 },
    { 37 , 91486784 , 5855247488 },
    { 38 , 91749824 , 5872024448 },
    { 39 , 92012224 , 5888799872 },
    { 40 , 92273344 , 5905576832 },
    { 41 , 92536768 , 5922352768 },
    { 42 , 92798912 , 5939132288 },
    { 43 , 93060544 , 5955911296 },
    { 44 , 93322816 , 5972688256 },
    { 45 , 93583936 , 5989465472 },
    { 46 , 93845056 , 6006241408 },
    { 47 , 94109504 , 6023015552 },
    { 48 , 94371776 , 6039796096 },
    { 49 , 94632896 , 6056574848 },
    { 50 , 94895552 , 6073351808 },
    { 51 , 95158208 , 6090128768 },
    { 52 , 95420224 , 6106906496 },
    { 53 , 95681216 , 6123680896 },
    { 54 , 95943872 , 6140459648 },
    { 55 , 96203584 , 6157237376 },
    { 56 , 96468544 , 6174009728 },
    { 57 , 96731072 , 6190792064 },
    { 58 , 96992576 , 6207569792 },
    { 59 , 97254848 , 6224345216 },
    { 60 , 97517248 , 6241124224 },
    { 61 , 97779392 , 6257899136 },
    { 62 , 98041408 , 6274676864 },
    { 63 , 98303168 , 6291454336 },
    { 64 , 98565568 , 6308232064 },
    { 65 , 98827328 , 6325006208 },
    { 66 , 99089728 , 6341784704 },
    { 67 , 99352384 , 6358562176 },
    { 68 , 99614272 , 6375337856 },
    { 69 , 99876416 , 6392119168 },
    { 70 , 100138048 , 6408895616 },
    { 71 , 100401088 , 6425673344 },
    { 72 , 100662592 , 6442444672 },
    { 73 , 100925248 , 6459223424 },
    { 74 , 101187392 , 6476004224 },
    { 75 , 101449408 , 6492781952 },
    { 76 , 101711296 , 6509555072 },
    { 77 , 101973824 , 6526336384 },
    { 78 , 102235712 , 6543112832 },
    { 79 , 102498112 , 6559888768 },
    { 80 , 102760384 , 6576662912 },
    { 81 , 103021888 , 6593443456 },
    { 82 , 103284032 , 6610219648 },
    { 83 , 103545152 , 6626999168 },
    { 84 , 103808576 , 6643777408 },
    { 85 , 104070976 , 6660552832 },
    { 86 , 104332736 , 6677330048 },
    { 87 , 104594752 , 6694107776 },
    { 88 , 104854592 , 6710882176 },
    { 89 , 105118912 , 6727662976 },
    { 90 , 105381184 , 6744437632 },
    { 91 , 105643072 , 6761213824 },
    { 92 , 105903296 , 6777993856 },
    { 93 , 106167872 , 6794770816 },
    { 94 , 106429504 , 6811549312 },
    { 95 , 106691392 , 6828326528 },
    { 96 , 106954304 , 6845101696 },
    { 97 , 107216576 , 6861880448 },
    { 98 , 107478464 , 6878655104 },
    { 99 , 107739712 , 6895433344 },
    { 100 , 108003136 , 6912212864 },
    { 101 , 108265408 , 6928988288 },
    { 102 , 108527168 , 6945764992 },
    { 103 , 108789568 , 6962544256 },
    { 104 , 109049792 , 6979317376 },
    { 105 , 109312576 , 6996093824 },
    { 106 , 109572928 , 7012875392 },
    { 107 , 109837888 , 7029652352 },
    { 108 , 110099648 , 7046427776 },
    { 109 , 110362432 , 7063207808 },
    { 110 , 110624704 , 7079980928 },
    { 111 , 110886208 , 7096759424 },
    { 112 , 111148864 , 7113536896 },
    { 113 , 111410752 , 7130315392 },
    { 114 , 111673024 , 7147092352 },
    { 115 , 111933632 , 7163865728 },
    { 116 , 112196416 , 7180648064 },
    { 117 , 112457792 , 7197424768 },
    { 118 , 112715968 , 7214196608 },
    { 119 , 112983616 , 7230975104 },
    { 120 , 113244224 , 7247755904 },
    { 121 , 113505472 , 7264533376 },
    { 122 , 113770304 , 7281308032 },
    { 123 , 114031552 , 7298088832 },
    { 124 , 114294592 , 7314864512 },
    { 125 , 114556864 , 7331643008 },
    { 126 , 114818624 , 7348419712 },
    { 127 , 115080512 , 7365196672 },
    { 128 , 115343296 , 7381973888 },
    { 129 , 115605184 , 7398750592 },
    { 130 , 115867072 , 7415528576 },
    { 131 , 116128576 , 7432302208 },
    { 132 , 116391488 , 7449080192 },
    { 133 , 116652992 , 7465860992 },
    { 134 , 116915648 , 7482635648 },
    { 135 , 117178304 , 7499412608 },
    { 136 , 117440192 , 7516192384 },
    { 137 , 117701824 , 7532967296 },
    { 138 , 117964096 , 7549745792 },
    { 139 , 118225984 , 7566524032 },
    { 140 , 118489024 , 7583300992 },
    { 141 , 118749632 , 7600075136 },
    { 142 , 119012416 , 7616854912 },
    { 143 , 119275328 , 7633629824 },
    { 144 , 119537344 , 7650410368 },
    { 145 , 119798464 , 7667187328 },
    { 146 , 120061376 , 7683961984 },
    { 147 , 120321728 , 7700739712 },
    { 148 , 120584512 , 7717519232 },
    { 149 , 120848192 , 7734295424 },
    { 150 , 121109056 , 7751069056 },
    { 151 , 121372352 , 7767849088 },
    { 152 , 121634752 , 7784626816 },
    { 153 , 121895744 , 7801405312 },
    { 154 , 122157632 , 7818179968 },
    { 155 , 122421184 , 7834957184 },
    { 156 , 122682944 , 7851732352 },
    { 157 , 122945344 , 7868512384 },
    { 158 , 123207488 , 7885287808 },
    { 159 , 123468736 , 7902067072 },
    { 160 , 123731264 , 7918844288 },
    { 161 , 123993664 , 7935622784 },
    { 162 , 124256192 , 7952400256 },
    { 163 , 124518208 , 7969176704 },
    { 164 , 124778048 , 7985953408 },
    { 165 , 125041088 , 8002730368 },
    { 166 , 125303744 , 8019508096 },
    { 167 , 125566912 , 8036285056 },
    { 168 , 125829056 , 8053062272 },
    { 169 , 126090304 , 8069838464 },
    { 170 , 126352832 , 8086616704 },
    { 171 , 126615232 , 8103393664 },
    { 172 , 126876608 , 8120171392 },
    { 173 , 127139392 , 8136949376 },
    { 174 , 127401152 , 8153726848 },
    { 175 , 127663552 , 8170503296 },
    { 176 , 127925696 , 8187280768 },
    { 177 , 128188096 , 8204058496 },
    { 178 , 128449856 , 8220834176 },
    { 179 , 128712256 , 8237612672 },
    { 180 , 128973632 , 8254389376 },
    { 181 , 129236288 , 8271167104 },
    { 182 , 129498944 , 8287944064 },
    { 183 , 129760832 , 8304715136 },
    { 184 , 130023104 , 8321497984 },
    { 185 , 130283968 , 8338274432 },
    { 186 , 130547008 , 8355052928 },
    { 187 , 130807616 , 8371828352 },
    { 188 , 131071552 , 8388606592 },
    { 189 , 131331776 , 8405384576 },
    { 190 , 131594048 , 8422161536 },
    { 191 , 131858368 , 8438939008 },
    { 192 , 132120256 , 8455715456 },
    { 193 , 132382528 , 8472492928 },
    { 194 , 132644672 , 8489270656 },
    { 195 , 132905792 , 8506045312 },
    { 196 , 133168832 , 8522823808 },
    { 197 , 133429312 , 8539602304 },
    { 198 , 133692992 , 8556378752 },
    { 199 , 133954624 , 8573154176 },
    { 200 , 134217152 , 8589933952 },
    { 201 , 134479808 , 8606705024 },
    { 202 , 134741056 , 8623487872 },
    { 203 , 135002944 , 8640264064 },
    { 204 , 135265472 , 8657040256 },
    { 205 , 135527872 , 8673820544 },
    { 206 , 135787712 , 8690592128 },
    { 207 , 136052416 , 8707374464 },
    { 208 , 136313792 , 8724151424 },
    { 209 , 136576448 , 8740928384 },
    { 210 , 136837952 , 8757704576 },
    { 211 , 137099584 , 8774480768 },
    { 212 , 137363392 , 8791260032 },
    { 213 , 137625536 , 8808034432 },
    { 214 , 137887424 , 8824812928 },
    { 215 , 138149824 , 8841591424 },
    { 216 , 138411584 , 8858366336 },
    { 217 , 138672832 , 8875147136 },
    { 218 , 138936128 , 8891923328 },
    { 219 , 139196864 , 8908700288 },
    { 220 , 139460032 , 8925478784 },
    { 221 , 139721024 , 8942250368 },
    { 222 , 139984576 , 8959032704 },
    { 223 , 140245696 , 8975809664 },
    { 224 , 140508352 , 8992584064 },
    { 225 , 140769856 , 9009362048 },
    { 226 , 141032768 , 9026141312 },
    { 227 , 141294016 , 9042917504 },
    { 228 , 141556544 , 9059694208 },
    { 229 , 141819584 , 9076471424 },
    { 230 , 142080448 , 9093250688 },
    { 231 , 142342336 , 9110027648 },
    { 232 , 142606144 , 9126803584 },
    { 233 , 142868288 , 9143581312 },
    { 234 , 143129408 , 9160356224 },
    { 235 , 143392448 , 9177134464 },
    { 236 , 143653696 , 9193910144 },
    { 237 , 143916992 , 9210690688 },
    { 238 , 144177856 , 9227465344 },
    { 239 , 144440768 , 9244244864 },
    { 240 , 144701888 , 9261021824 },
    { 241 , 144965056 , 9277799296 },
    { 242 , 145227584 , 9294574208 },
    { 243 , 145489856 , 9311351936 },
    { 244 , 145751488 , 9328131968 },
    { 245 , 146011456 , 9344907392 },
    { 246 , 146275264 , 9361685888 },
    { 247 , 146538176 , 9378463616 },
    { 248 , 146800448 , 9395239808 },
    { 249 , 147062336 , 9412016512 },
    { 250 , 147324224 , 9428795008 },
    { 251 , 147586624 , 9445570688 },
    { 252 , 147848768 , 9462346624 },
    { 253 , 148110784 , 9479121536 },
    { 254 , 148373312 , 9495903616 },
    { 255 , 148635584 , 9512678528 },
    { 256 , 148897088 , 9529456256 },
    { 257 , 149159488 , 9546233728 },
    { 258 , 149420224 , 9563011456 },
    { 259 , 149683136 , 9579788672 },
    { 260 , 149943616 , 9596567168 },
    { 261 , 150208064 , 9613343104 },
    { 262 , 150470464 , 9630121856 },
    { 263 , 150732224 , 9646898816 },
    { 264 , 150993088 , 9663675776 },
    { 265 , 151254976 , 9680449664 },
    { 266 , 151519168 , 9697230464 },
    { 267 , 151778752 , 9714003584 },
    { 268 , 152042944 , 9730772608 },
    { 269 , 152304704 , 9747561088 },
    { 270 , 152567488 , 9764338816 },
    { 271 , 152828992 , 9781116544 },
    { 272 , 153091648 , 9797892992 },
    { 273 , 153353792 , 9814670464 },
    { 274 , 153616192 , 9831439232 },
    { 275 , 153878336 , 9848224384 },
    { 276 , 154139968 , 9865000576 },
    { 277 , 154402624 , 9881772416 },
    { 278 , 154663616 , 9898556288 },
    { 279 , 154926272 , 9915333248 },
    { 280 , 155188928 , 9932108672 },
    { 281 , 155450816 , 9948888448 },
    { 282 , 155712064 , 9965666176 },
    { 283 , 155971136 , 9982441088 },
    { 284 , 156237376 , 9999219584 },
    { 285 , 156499264 , 10015996544 },
    { 286 , 156761536 , 10032774016 },
    { 287 , 157024064 , 10049548928 },
    { 288 , 157284416 , 10066329472 },
    { 289 , 157545536 , 10083105152 },
    { 290 , 157810496 , 10099878784 },
    { 291 , 158071744 , 10116660608 },
    { 292 , 158334656 , 10133437312 },
    { 293 , 158596288 , 10150213504 },
    { 294 , 158858048 , 10166991232 },
    { 295 , 159121216 , 10183766144 },
    { 296 , 159381568 , 10200545408 },
    { 297 , 159645632 , 10217322112 },
    { 298 , 159906496 , 10234099328 },
    { 299 , 160169536 , 10250876032 },
    { 300 , 160430656 , 10267656064 },
    { 301 , 160693952 , 10284429184 },
    { 302 , 160956352 , 10301209472 },
    { 303 , 161217344 , 10317987712 },
    { 304 , 161480512 , 10334763392 },
    { 305 , 161742272 , 10351541632 },
    { 306 , 162002752 , 10368318592 },
    { 307 , 162266432 , 10385096576 },
    { 308 , 162529216 , 10401867136 },
    { 309 , 162790976 , 10418647424 },
    { 310 , 163052096 , 10435425664 },
    { 311 , 163314752 , 10452203648 },
    { 312 , 163577408 , 10468982144 },
    { 313 , 163839296 , 10485759104 },
    { 314 , 164100928 , 10502533504 },
    { 315 , 164364224 , 10519313536 },
    { 316 , 164625856 , 10536091264 },
    { 317 , 164887616 , 10552867712 },
    { 318 , 165150016 , 10569642368 },
    { 319 , 165412672 , 10586423168 },
    { 320 , 165674944 , 10603200128 },
    { 321 , 165936832 , 10619976064 },
    { 322 , 166198336 , 10636754048 },
    { 323 , 166461248 , 10653531776 },
    { 324 , 166722496 , 10670307968 },
    { 325 , 166985408 , 10687086464 },
    { 326 , 167246656 , 10703863168 },
    { 327 , 167508416 , 10720639616 },
    { 328 , 167771584 , 10737414784 },
    { 329 , 168034112 , 10754190976 },
    { 330 , 168295744 , 10770971264 },
    { 331 , 168557632 , 10787747456 },
    { 332 , 168819136 , 10804525184 },
    { 333 , 169082176 , 10821301888 },
    { 334 , 169344832 , 10838078336 },
    { 335 , 169605952 , 10854858368 },
    { 336 , 169866304 , 10871631488 },
    { 337 , 170131264 , 10888412032 },
    { 338 , 170393536 , 10905188992 },
    { 339 , 170655424 , 10921964672 },
    { 340 , 170917696 , 10938742912 },
    { 341 , 171179072 , 10955518592 },
    { 342 , 171439936 , 10972298368 },
    { 343 , 171702976 , 10989074816 },
    { 344 , 171966272 , 11005851776 },
    { 345 , 172228288 , 11022627712 },
    { 346 , 172489664 , 11039403904 },
    { 347 , 172747712 , 11056184704 },
    { 348 , 173014208 , 11072960896 },
    { 349 , 173275072 , 11089737856 },
    { 350 , 173539136 , 11106514816 },
    { 351 , 173800768 , 11123293568 },
    { 352 , 174063424 , 11140065152 },
    { 353 , 174325696 , 11156845696 },
    { 354 , 174586816 , 11173624192 },
    { 355 , 174849728 , 11190402688 },
    { 356 , 175109696 , 11207179136 },
    { 357 , 175374272 , 11223957376 },
    { 358 , 175636288 , 11240734592 },
    { 359 , 175898432 , 11257511296 },
    { 360 , 176159936 , 11274285952 },
    { 361 , 176422592 , 11291065472 },
    { 362 , 176684864 , 11307842432 },
    { 363 , 176946496 , 11324616832 },
    { 364 , 177209152 , 11341395584 },
    { 365 , 177470528 , 11358172288 },
    { 366 , 177731648 , 11374950016 },
    { 367 , 177994816 , 11391721856 },
    { 368 , 178257472 , 11408504192 },
    { 369 , 178518464 , 11425283456 },
    { 370 , 178781888 , 11442061184 },
    { 371 , 179044288 , 11458837888 },
    { 372 , 179305024 , 11475611776 },
    { 373 , 179568448 , 11492392064 },
    { 374 , 179830208 , 11509169024 },
    { 375 , 180092608 , 11525944448 },
    { 376 , 180354752 , 11542724224 },
    { 377 , 180617152 , 11559500672 },
    { 378 , 180877504 , 11576277376 },
    { 379 , 181139264 , 11593056128 },
    { 380 , 181402688 , 11609830016 },
    { 381 , 181663168 , 11626607488 },
    { 382 , 181926592 , 11643387776 },
    { 383 , 182190016 , 11660161664 },
    { 384 , 182451904 , 11676940928 },
    { 385 , 182713792 , 11693718656 },
    { 386 , 182976064 , 11710496128 },
    { 387 , 183237056 , 11727273088 },
    { 388 , 183494848 , 11744050048 },
    { 389 , 183762752 , 11760824704 },
    { 390 , 184024768 , 11777604736 },
    { 391 , 184286656 , 11794381952 },
    { 392 , 184548928 , 11811157888 },
    { 393 , 184810816 , 11827932544 },
    { 394 , 185072704 , 11844713344 },
    { 395 , 185335616 , 11861486464 },
    { 396 , 185596352 , 11878268032 },
    { 397 , 185859904 , 11895044992 },
    { 398 , 186121664 , 11911822976 },
    { 399 , 186383552 , 11928600448 },
    { 400 , 186645952 , 11945375872 },
    { 401 , 186907328 , 11962151296 },
    { 402 , 187170112 , 11978928512 },
    { 403 , 187429184 , 11995708288 },
    { 404 , 187693504 , 12012486272 },
    { 405 , 187957184 , 12029255552 },
    { 406 , 188218304 , 12046039168 },
    { 407 , 188481344 , 12062813824 },
    { 408 , 188743616 , 12079594624 },
    { 409 , 189005248 , 12096371072 },
    { 410 , 189265088 , 12113147264 },
    { 411 , 189528128 , 12129924992 },
    { 412 , 189791936 , 12146703232 },
    { 413 , 190054208 , 12163481216 },
    { 414 , 190315072 , 12180255872 },
    { 415 , 190577984 , 12197034112 },
    { 416 , 190840768 , 12213811328 },
    { 417 , 191102656 , 12230590336 },
    { 418 , 191364032 , 12247365248 },
    { 419 , 191626816 , 12264143488 },
    { 420 , 191888192 , 12280920448 },
    { 421 , 192148928 , 12297694592 },
    { 422 , 192413504 , 12314475392 },
    { 423 , 192674752 , 12331253632 },
    { 424 , 192937792 , 12348029312 },
    { 425 , 193198912 , 12364805248 },
    { 426 , 193462208 , 12381580928 },
    { 427 , 193723456 , 12398357632 },
    { 428 , 193985984 , 12415138432 },
    { 429 , 194247232 , 12431916416 },
    { 430 , 194508352 , 12448692352 },
    { 431 , 194772544 , 12465467776 },
    { 432 , 195035072 , 12482245504 },
    { 433 , 195296704 , 12499025536 },
    { 434 , 195558592 , 12515801728 },
    { 435 , 195818176 , 12532577152 },
    { 436 , 196083392 , 12549354368 },
    { 437 , 196345792 , 12566129536 },
    { 438 , 196607552 , 12582911872 },
    { 439 , 196869952 , 12599688064 },
    { 440 , 197130688 , 12616463488 },
    { 441 , 197394368 , 12633239936 },
    { 442 , 197656384 , 12650019968 },
    { 443 , 197916608 , 12666795136 },
    { 444 , 198180544 , 12683574656 },
    { 445 , 198442432 , 12700350592 },
    { 446 , 198705088 , 12717128576 },
    { 447 , 198967232 , 12733906816 },
    { 448 , 199228352 , 12750680192 },
    { 449 , 199491392 , 12767460736 },
    { 450 , 199751744 , 12784236928 },
    { 451 , 200014016 , 12801014656 },
    { 452 , 200276672 , 12817789312 },
    { 453 , 200540096 , 12834568832 },
    { 454 , 200801984 , 12851345792 },
    { 455 , 201062464 , 12868122496 },
    { 456 , 201326144 , 12884901248 },
    { 457 , 201588544 , 12901672832 },
    { 458 , 201850816 , 12918455168 },
    { 459 , 202111552 , 12935232896 },
    { 460 , 202374464 , 12952009856 },
    { 461 , 202636352 , 12968786816 },
    { 462 , 202898368 , 12985563776 },
    { 463 , 203159872 , 13002341504 },
    { 464 , 203423296 , 13019115392 },
    { 465 , 203685824 , 13035895168 },
    { 466 , 203947712 , 13052673152 },
    { 467 , 204208192 , 13069446272 },
    { 468 , 204472256 , 13086227072 },
    { 469 , 204733888 , 13103000192 },
    { 470 , 204996544 , 13119782528 },
    { 471 , 205258304 , 13136559232 },
    { 472 , 205517632 , 13153329536 },
    { 473 , 205782208 , 13170111872 },
    { 474 , 206044736 , 13186884736 },
    { 475 , 206307008 , 13203667072 },
    { 476 , 206569024 , 13220445824 },
    { 477 , 206831168 , 13237221248 },
    { 478 , 207093056 , 13254000512 },
    { 479 , 207355328 , 13270777472 },
    { 480 , 207616832 , 13287553408 },
    { 481 , 207879104 , 13304331904 },
    { 482 , 208141888 , 13321108096 },
    { 483 , 208404032 , 13337885824 },
    { 484 , 208666048 , 13354663808 },
    { 485 , 208927424 , 13371439232 },
    { 486 , 209189824 , 13388210816 },
    { 487 , 209451584 , 13404995456 },
    { 488 , 209715136 , 13421771392 },
    { 489 , 209976896 , 13438546048 },
    { 490 , 210239296 , 13455326848 },
    { 491 , 210501568 , 13472103808 },
    { 492 , 210763712 , 13488875648 },
    { 493 , 211024832 , 13505657728 },
    { 494 , 211287616 , 13522435712 },
    { 495 , 211549376 , 13539210112 },
    { 496 , 211812032 , 13555989376 },
    { 497 , 212074432 , 13572766336 },
    { 498 , 212334016 , 13589544832 },
    { 499 , 212597824 , 13606320512 },
    { 500 , 212860352 , 13623097472 },
    { 501 , 213120832 , 13639874944 },
    { 502 , 213385024 , 13656652928 },
    { 503 , 213645632 , 13673430656 },
    { 504 , 213909184 , 13690207616 },
    { 505 , 214170688 , 13706982272 },
    { 506 , 214433728 , 13723762048 },
    { 507 , 214695232 , 13740536704 },
    { 508 , 214956992 , 13757316224 },
    { 509 , 215219776 , 13774090112 },
    { 510 , 215482304 , 13790869376 },
    { 511 , 215743552 , 13807647872 },
    { 512 , 216005312 , 13824425344 },
    { 513 , 216267328 , 13841202304 },
    { 514 , 216530752 , 13857978752 },
    { 515 , 216790592 , 13874754688 },
    { 516 , 217054528 , 13891533184 },
    { 517 , 217316672 , 13908311168 },
    { 518 , 217579072 , 13925085056 },
    { 519 , 217838912 , 13941866368 },
    { 520 , 218102848 , 13958643584 },
    { 521 , 218364736 , 13975417216 },
    { 522 , 218627776 , 13992197504 },
    { 523 , 218888896 , 14008973696 },
    { 524 , 219151936 , 14025752192 },
    { 525 , 219413056 , 14042528384 },
    { 526 , 219675968 , 14059301504 },
    { 527 , 219938624 , 14076083584 },
    { 528 , 220200128 , 14092852352 },
    { 529 , 220461632 , 14109635968 },
    { 530 , 220725184 , 14126407552 },
    { 531 , 220987072 , 14143188608 },
    { 532 , 221249216 , 14159968384 },
    { 533 , 221510336 , 14176741504 },
    { 534 , 221772736 , 14193521024 },
    { 535 , 222031808 , 14210301824 },
    { 536 , 222297536 , 14227067264 },
    { 537 , 222559936 , 14243855488 },
    { 538 , 222820672 , 14260630144 },
    { 539 , 223083968 , 14277409408 },
    { 540 , 223345984 , 14294187904 },
    { 541 , 223608512 , 14310961792 },
    { 542 , 223869376 , 14327738752 },
    { 543 , 224132672 , 14344518784 },
    { 544 , 224394944 , 14361296512 },
    { 545 , 224657344 , 14378071424 },
    { 546 , 224919488 , 14394848128 },
    { 547 , 225181504 , 14411627392 },
    { 548 , 225443776 , 14428402304 },
    { 549 , 225704768 , 14445181568 },
    { 550 , 225966784 , 14461959808 },
    { 551 , 226229824 , 14478737024 },
    { 552 , 226491712 , 14495511424 },
    { 553 , 226754368 , 14512291712 },
    { 554 , 227015104 , 14529064832 },
    { 555 , 227278528 , 14545845632 },
    { 556 , 227539904 , 14562618496 },
    { 557 , 227802944 , 14579398784 },
    { 558 , 228065216 , 14596172672 },
    { 559 , 228326464 , 14612953984 },
    { 560 , 228588736 , 14629724288 },
    { 561 , 228850112 , 14646503296 },
    { 562 , 229113152 , 14663284864 },
    { 563 , 229375936 , 14680061056 },
    { 564 , 229636928 , 14696835968 },
    { 565 , 229894976 , 14713616768 },
    { 566 , 230162368 , 14730392192 },
    { 567 , 230424512 , 14747172736 },
    { 568 , 230684864 , 14763947648 },
    { 569 , 230948416 , 14780725376 },
    { 570 , 231210944 , 14797499776 },
    { 571 , 231472448 , 14814276992 },
    { 572 , 231733952 , 14831056256 },
    { 573 , 231996736 , 14847836032 },
    { 574 , 232259392 , 14864612992 },
    { 575 , 232521664 , 14881388672 },
    { 576 , 232782272 , 14898165376 },
    { 577 , 233043904 , 14914944896 },
    { 578 , 233306816 , 14931721856 },
    { 579 , 233569984 , 14948497024 },
    { 580 , 233830592 , 14965276544 },
    { 581 , 234092224 , 14982053248 },
    { 582 , 234353984 , 14998830976 },
    { 583 , 234618304 , 15015605888 },
    { 584 , 234880832 , 15032385152 },
    { 585 , 235142464 , 15049154944 },
    { 586 , 235403456 , 15065939072 },
    { 587 , 235667392 , 15082715008 },
    { 588 , 235928768 , 15099493504 },
    { 589 , 236190272 , 15116269184 },
    { 590 , 236453312 , 15133042304 },
    { 591 , 236715712 , 15149824384 },
    { 592 , 236976448 , 15166602368 },
    { 593 , 237239104 , 15183378304 },
    { 594 , 237501632 , 15200154496 },
    { 595 , 237764416 , 15216931712 },
    { 596 , 238026688 , 15233708416 },
    { 597 , 238286912 , 15250489216 },
    { 598 , 238548032 , 15267265408 },
    { 599 , 238812608 , 15284043136 },
    { 600 , 239075008 , 15300819584 },
    { 601 , 239335232 , 15317596544 },
    { 602 , 239599168 , 15334374784 },
    { 603 , 239861312 , 15351151744 },
    { 604 , 240122816 , 15367929728 },
    { 605 , 240385856 , 15384706432 },
    { 606 , 240647872 , 15401481856 },
    { 607 , 240909632 , 15418258816 },
    { 608 , 241171904 , 15435037568 },
    { 609 , 241433408 , 15451815296 },
    { 610 , 241696192 , 15468589184 },
    { 611 , 241958848 , 15485369216 },
    { 612 , 242220224 , 15502146944 },
    { 613 , 242481856 , 15518924416 },
    { 614 , 242744896 , 15535699072 },
    { 615 , 243005632 , 15552478336 },
    { 616 , 243268672 , 15569254528 },
    { 617 , 243531712 , 15586031488 },
    { 618 , 243793856 , 15602809472 },
    { 619 , 244054592 , 15619586432 },
    { 620 , 244316608 , 15636364928 },
    { 621 , 244580032 , 15653141888 },
    { 622 , 244841536 , 15669918848 },
    { 623 , 245104448 , 15686696576 },
    { 624 , 245365312 , 15703474048 },
    { 625 , 245628736 , 15720251264 },
    { 626 , 245889856 , 15737027456 },
    { 627 , 246152512 , 15753804928 },
    { 628 , 246415168 , 15770582656 },
    { 629 , 246675904 , 15787358336 },
    { 630 , 246939584 , 15804132224 },
    { 631 , 247199552 , 15820909696 },
    { 632 , 247463872 , 15837691264 },
    { 633 , 247726016 , 15854466944 },
    { 634 , 247987648 , 15871244672 },
    { 635 , 248249536 , 15888020608 },
    { 636 , 248512064 , 15904799104 },
    { 637 , 248773312 , 15921577088 },
    { 638 , 249036608 , 15938354816 },
    { 639 , 249298624 , 15955129472 },
    { 640 , 249560512 , 15971907968 },
    { 641 , 249822784 , 15988684928 },
    { 642 , 250085312 , 16005460864 },
    { 643 , 250345792 , 16022241152 },
    { 644 , 250608704 , 16039012736 },
    { 645 , 250870976 , 16055794816 },
    { 646 , 251133632 , 16072571264 },
    { 647 , 251395136 , 16089346688 },
    { 648 , 251657792 , 16106125184 },
    { 649 , 251919424 , 16122904192 },
    { 650 , 252182464 , 16139678848 },
    { 651 , 252444224 , 16156453504 },
    { 652 , 252706624 , 16173236096 },
    { 653 , 252968512 , 16190012032 },
    { 654 , 253227584 , 16206790528 },
    { 655 , 253493056 , 16223567744 },
    { 656 , 253754432 , 16240344704 },
    { 657 , 254017216 , 16257117824 },
    { 658 , 254279488 , 16273898624 },
    { 659 , 254541376 , 16290668672 },
    { 660 , 254803264 , 16307449216 },
    { 661 , 255065792 , 16324230016 },
    { 662 , 255326528 , 16341006464 },
    { 663 , 255589952 , 16357783168 },
    { 664 , 255851072 , 16374561664 },
    { 665 , 256114624 , 16391337856 },
    { 666 , 256374208 , 16408116352 },
    { 667 , 256636096 , 16424892032 },
    { 668 , 256900544 , 16441668224 },
    { 669 , 257162176 , 16458448768 },
    { 670 , 257424448 , 16475224448 },
    { 671 , 257686976 , 16492001408 },
    { 672 , 257949632 , 16508779648 },
    { 673 , 258211136 , 16525555328 },
    { 674 , 258473408 , 16542330752 },
    { 675 , 258734656 , 16559110528 },
    { 676 , 258996544 , 16575888512 },
    { 677 , 259260224 , 16592665472 },
    { 678 , 259522112 , 16609442944 },
    { 679 , 259784384 , 16626218624 },
    { 680 , 260045888 , 16642996096 },
    { 681 , 260308544 , 16659773824 },
    { 682 , 260570944 , 16676552576 },
    { 683 , 260832448 , 16693328768 },
    { 684 , 261092672 , 16710095488 },
    { 685 , 261356864 , 16726883968 },
    { 686 , 261619648 , 16743661184 },
    { 687 , 261879872 , 16760436608 },
    { 688 , 262143424 , 16777214336 },
    { 689 , 262404416 , 16793992832 },
    { 690 , 262667968 , 16810768768 },
    { 691 , 262928704 , 16827542656 },
    { 692 , 263191744 , 16844323712 },
    { 693 , 263454656 , 16861101952 },
    { 694 , 263716672 , 16877876864 },
    { 695 , 263978944 , 16894653056 },
    { 696 , 264241088 , 16911431296 },
    { 697 , 264501184 , 16928207488 },
    { 698 , 264764096 , 16944987776 },
    { 699 , 265024576 , 16961763968 },
    { 700 , 265287488 , 16978540928 },
    { 701 , 265550528 , 16995319168 },
    { 702 , 265813312 , 17012096896 },
    { 703 , 266075968 , 17028870784 },
    { 704 , 266337728 , 17045649536 },
    { 705 , 266600384 , 17062426496 },
    { 706 , 266862272 , 17079205504 },
    { 707 , 267124288 , 17095978112 },
    { 708 , 267386432 , 17112759424 },
    { 709 , 267648704 , 17129536384 },
    { 710 , 267910592 , 17146314368 },
    { 711 , 268172096 , 17163089792 },
    { 712 , 268435264 , 17179864192 },
    { 713 , 268696256 , 17196644992 },
    { 714 , 268959296 , 17213423488 },
    { 715 , 269221312 , 17230198912 },
    { 716 , 269482688 , 17246976896 },
    { 717 , 269745856 , 17263754624 },
    { 718 , 270007616 , 17280530048 },
    { 719 , 270270272 , 17297309312 },
    { 720 , 270531904 , 17314085504 },
    { 721 , 270791744 , 17330863744 },
    { 722 , 271056832 , 17347640192 },
    { 723 , 271317184 , 17364413824 },
    { 724 , 271580992 , 17381190016 },
    { 725 , 271843136 , 17397972608 },
    { 726 , 272105408 , 17414748544 },
    { 727 , 272367296 , 17431527296 },
    { 728 , 272629568 , 17448303232 },
    { 729 , 272891456 , 17465081728 },
    { 730 , 273153856 , 17481857408 },
    { 731 , 273415616 , 17498635904 },
    { 732 , 273677632 , 17515409024 },
    { 733 , 273937088 , 17532189824 },
    { 734 , 274200896 , 17548966016 },
    { 735 , 274463296 , 17565741184 },
    { 736 , 274726208 , 17582519168 },
    { 737 , 274988992 , 17599296128 },
    { 738 , 275250496 , 17616076672 },
    { 739 , 275513024 , 17632852352 },
    { 740 , 275775296 , 17649630848 },
    { 741 , 276037184 , 17666403968 },
    { 742 , 276297664 , 17683178368 },
    { 743 , 276560576 , 17699962496 },
    { 744 , 276822976 , 17716739968 },
    { 745 , 277085632 , 17733517184 },
    { 746 , 277347008 , 17750293888 },
    { 747 , 277609664 , 17767070336 },
    { 748 , 277868608 , 17783848832 },
    { 749 , 278134336 , 17800625536 },
    { 750 , 278395328 , 17817402752 },
    { 751 , 278657728 , 17834178944 },
    { 752 , 278921152 , 17850955648 },
    { 753 , 279182912 , 17867732864 },
    { 754 , 279443776 , 17884511872 },
    { 755 , 279706048 , 17901287296 },
    { 756 , 279969728 , 17918058112 },
    { 757 , 280230976 , 17934843776 },
    { 758 , 280493632 , 17951609216 },
    { 759 , 280755392 , 17968397696 },
    { 760 , 281018176 , 17985175424 },
    { 761 , 281278912 , 18001952128 },
    { 762 , 281542592 , 18018728576 },
    { 763 , 281803712 , 18035503232 },
    { 764 , 282066496 , 18052283264 },
    { 765 , 282329024 , 18069056384 },
    { 766 , 282590272 , 18085837184 },
    { 767 , 282853184 , 18102613376 },
    { 768 , 283115072 , 18119388544 },
    { 769 , 283377344 , 18136170368 },
    { 770 , 283639744 , 18152947328 },
    { 771 , 283901504 , 18169724288 },
    { 772 , 284163136 , 18186498944 },
    { 773 , 284426176 , 18203275648 },
    { 774 , 284687296 , 18220048768 },
    { 775 , 284950208 , 18236833408 },
    { 776 , 285211712 , 18253610624 },
    { 777 , 285474368 , 18270387328 },
    { 778 , 285735872 , 18287163008 },
    { 779 , 285998656 , 18303941504 },
    { 780 , 286260928 , 18320717696 },
    { 781 , 286522688 , 18337496192 },
    { 782 , 286784192 , 18354269056 },
    { 783 , 287046976 , 18371050112 },
    { 784 , 287308352 , 18387828352 },
    { 785 , 287571776 , 18404605568 },
    { 786 , 287833792 , 18421379456 },
    { 787 , 288095552 , 18438154624 },
    { 788 , 288358208 , 18454937216 },
    { 789 , 288618688 , 18471713408 },
    { 790 , 288882112 , 18488488576 },
    { 791 , 289143872 , 18505268864 },
    { 792 , 289406528 , 18522045056 },
    { 793 , 289667648 , 18538823552 },
    { 794 , 289931072 , 18555600512 },
    { 795 , 290193088 , 18572377216 },
    { 796 , 290453312 , 18589154432 },
    { 797 , 290717248 , 18605931392 },
    { 798 , 290978752 , 18622708352 },
    { 799 , 291240896 , 18639486848 },
    { 800 , 291504064 , 18656262784 },
    { 801 , 291765952 , 18673037696 },
    { 802 , 292028096 , 18689814656 },
    { 803 , 292290496 , 18706594688 },
    { 804 , 292550848 , 18723370112 },
    { 805 , 292813888 , 18740150144 },
    { 806 , 293076928 , 18756927104 },
    { 807 , 293338816 , 18773701504 },
    { 808 , 293600192 , 18790481536 },
    { 809 , 293862848 , 18807258752 },
    { 810 , 294123328 , 18824034688 },
    { 811 , 294387136 , 18840813184 },
    { 812 , 294649664 , 18857585792 },
    { 813 , 294911168 , 18874365824 },
    { 814 , 295173184 , 18891145088 },
    { 815 , 295436096 , 18907911808 },
    { 816 , 295698112 , 18924697216 },
    { 817 , 295960384 , 18941475968 },
    { 818 , 296222656 , 18958250368 },
    { 819 , 296481728 , 18975028096 },
    { 820 , 296746816 , 18991807616 },
    { 821 , 297008704 , 19008584576 },
    { 822 , 297270592 , 19025360768 },
    { 823 , 297533248 , 19042140032 },
    { 824 , 297794624 , 19058916992 },
    { 825 , 298057664 , 19075694464 },
    { 826 , 298318912 , 19092468608 },
    { 827 , 298581056 , 19109247104 },
    { 828 , 298843456 , 19126026112 },
    { 829 , 299105728 , 19142802304 },
    { 830 , 299367872 , 19159578752 },
    { 831 , 299630528 , 19176355456 },
    { 832 , 299891776 , 19193133952 },
    { 833 , 300154304 , 19209910144 },
    { 834 , 300416192 , 19226688896 },
    { 835 , 300678464 , 19243466624 },
    { 836 , 300941248 , 19260243584 },
    { 837 , 301202624 , 19277018752 },
    { 838 , 301465408 , 19293797504 },
    { 839 , 301727168 , 19310572672 },
    { 840 , 301989056 , 19327352192 },
    { 841 , 302250304 , 19344129664 },
    { 842 , 302513216 , 19360906624 },
    { 843 , 302775232 , 19377681536 },
    { 844 , 303036736 , 19394460544 },
    { 845 , 303299008 , 19411236736 },
    { 846 , 303562304 , 19428008576 },
    { 847 , 303823424 , 19444790656 },
    { 848 , 304086976 , 19461568384 },
    { 849 , 304348864 , 19478344064 },
    { 850 , 304610752 , 19495124864 },
    { 851 , 304873024 , 19511901824 },
    { 852 , 305131072 , 19528678784 },
    { 853 , 305397056 , 19545453952 },
    { 854 , 305659712 , 19562226304 },
    { 855 , 305920448 , 19579002496 },
    { 856 , 306182848 , 19595787136 },
    { 857 , 306446144 , 19612564096 },
    { 858 , 306707264 , 19629339776 },
    { 859 , 306970304 , 19646115968 },
    { 860 , 307231168 , 19662895744 },
    { 861 , 307494848 , 19679670656 },
    { 862 , 307756864 , 19696450688 },
    { 863 , 308019136 , 19713227648 },
    { 864 , 308280512 , 19730003584 },
    { 865 , 308543168 , 19746781568 },
    { 866 , 308801728 , 19763557504 },
    { 867 , 309067712 , 19780336768 },
    { 868 , 309329344 , 19797113216 },
    { 869 , 309591872 , 19813891712 },
    { 870 , 309853888 , 19830666368 },
    { 871 , 310114496 , 19847444608 },
    { 872 , 310377664 , 19864222592 },
    { 873 , 310638784 , 19880991616 },
    { 874 , 310901056 , 19897776512 },
    { 875 , 311164864 , 19914552704 },
    { 876 , 311427008 , 19931329408 },
    { 877 , 311688896 , 19948107392 },
    { 878 , 311950784 , 19964885888 },
    { 879 , 312212416 , 19981661312 },
    { 880 , 312475456 , 19998441088 },
    { 881 , 312736832 , 20015211904 },
    { 882 , 312999488 , 20031993472 },
    { 883 , 313261504 , 20048772736 },
    { 884 , 313524032 , 20065547648 },
    { 885 , 313785664 , 20082326912 },
    { 886 , 314047424 , 20099103872 },
    { 887 , 314310208 , 20115880832 },
    { 888 , 314570944 , 20132657024 },
    { 889 , 314833216 , 20149436288 },
    { 890 , 315096512 , 20166212992 },
    { 891 , 315357376 , 20182989184 },
    { 892 , 315619904 , 20199764096 },
    { 893 , 315881792 , 20216541824 },
    { 894 , 316145216 , 20233319552 },
    { 895 , 316405952 , 20250098048 },
    { 896 , 316669376 , 20266874752 },
    { 897 , 316929472 , 20283654016 },
    { 898 , 317194048 , 20300427904 },
    { 899 , 317454784 , 20317207424 },
    { 900 , 317717824 , 20333985664 },
    { 901 , 317979328 , 20350760576 },
    { 902 , 318241856 , 20367539072 },
    { 903 , 318504896 , 20384316032 },
    { 904 , 318766528 , 20401083776 },
    { 905 , 319029056 , 20417869952 },
    { 906 , 319291328 , 20434646912 },
    { 907 , 319552448 , 20451422848 },
    { 908 , 319815616 , 20468202112 },
    { 909 , 320076992 , 20484977792 },
    { 910 , 320339776 , 20501757824 },
    { 911 , 320598976 , 20518534016 },
    { 912 , 320862656 , 20535312256 },
    { 913 , 321125696 , 20552089472 },
    { 914 , 321388352 , 20568861056 },
    { 915 , 321650624 , 20585643392 },
    { 916 , 321909568 , 20602420864 },
    { 917 , 322174784 , 20619195776 },
    { 918 , 322437056 , 20635966592 },
    { 919 , 322698944 , 20652750208 },
    { 920 , 322960576 , 20669528192 },
    { 921 , 323223104 , 20686304896 },
    { 922 , 323484992 , 20703082112 },
    { 923 , 323745728 , 20719859584 },
    { 924 , 324009536 , 20736635776 },
    { 925 , 324270656 , 20753415808 },
    { 926 , 324534208 , 20770191488 },
    { 927 , 324795712 , 20786968448 },
    { 928 , 325058368 , 20803746944 },
    { 929 , 325319872 , 20820520064 },
    { 930 , 325582528 , 20837301376 },
    { 931 , 325844672 , 20854077824 },
    { 932 , 326105792 , 20870854016 },
    { 933 , 326369216 , 20887632512 },
    { 934 , 326631232 , 20904409984 },
    { 935 , 326893376 , 20921186432 },
    { 936 , 327154624 , 20937962624 },
    { 937 , 327416384 , 20954742656 },
    { 938 , 327679808 , 20971515776 },
    { 939 , 327939776 , 20988295808 },
    { 940 , 328201792 , 21005074304 },
    { 941 , 328466368 , 21021848704 },
    { 942 , 328727744 , 21038626688 },
    { 943 , 328989632 , 21055404928 },
    { 944 , 329252416 , 21072181888 },
    { 945 , 329514176 , 21088958848 },
    { 946 , 329776192 , 21105736832 },
    { 947 , 330038336 , 21122514304 },
    { 948 , 330301376 , 21139292032 },
    { 949 , 330563264 , 21156069248 },
    { 950 , 330825536 , 21172845952 },
    { 951 , 331087808 , 21189622144 },
    { 952 , 331349696 , 21206397568 },
    { 953 , 331611584 , 21223175552 },
    { 954 , 331873856 , 21239954816 },
    { 955 , 332136256 , 21256724096 },
    { 956 , 332398016 , 21273509248 },
    { 957 , 332660672 , 21290286208 },
    { 958 , 332922176 , 21307063168 },
    { 959 , 333184832 , 21323837312 },
    { 960 , 333446336 , 21340616576 },
    { 961 , 333708736 , 21357394048 },
    { 962 , 333969728 , 21374169728 },
    { 963 , 334231232 , 21390949504 },
    { 964 , 334495424 , 21407727232 },
    { 965 , 334756672 , 21424499584 },
    { 966 , 335019968 , 21441281152 },
    { 967 , 335281472 , 21458058112 },
    { 968 , 335544128 , 21474829696 },
    { 969 , 335805248 , 21491613568 },
    { 970 , 336066496 , 21508386176 },
    { 971 , 336330688 , 21525166976 },
    { 972 , 336592832 , 21541944448 },
    { 973 , 336853568 , 21558721664 },
    { 974 , 337116608 , 21575499392 },
    { 975 , 337379264 , 21592276864 },
    { 976 , 337640896 , 21609052288 },
    { 977 , 337903168 , 21625830784 },
    { 978 , 338164928 , 21642607744 },
    { 979 , 338426944 , 21659385728 },
    { 980 , 338689984 , 21676160384 },
    { 981 , 338952128 , 21692932736 },
    { 982 , 339212992 , 21709716352 },
    { 983 , 339472832 , 21726491008 },
    { 984 , 339736256 , 21743271808 },
    { 985 , 340000576 , 21760048256 },
    { 986 , 340262848 , 21776820608 },
    { 987 , 340524736 , 21793603456 },
    { 988 , 340786496 , 21810378112 },
    { 989 , 341048128 , 21827157376 },
    { 990 , 341311424 , 21843922816 },
    { 991 , 341573312 , 21860712064 },
    { 992 , 341835328 , 21877489024 },
    { 993 , 342097472 , 21894265216 },
    { 994 , 342359744 , 21911040128 },
    { 995 , 342621632 , 21927819904 },
    { 996 , 342883648 , 21944597632 },
    { 997 , 343146304 , 21961375616 },
    { 998 , 343408064 , 21978150016 },
    { 999 , 343667776 , 21994928512 },
    { 1000 , 343931584 , 22011704192 },
    { 1001 , 344194112 , 22028481152 },
    { 1002 , 344455616 , 22045260928 },
    { 1003 , 344719168 , 22062038912 },
    { 1004 , 344980928 , 22078815872 },
    { 1005 , 345242048 , 22095591808 },
    { 1006 , 345504832 , 22112365952 },
    { 1007 , 345767872 , 22129146752 },
    { 1008 , 346030016 , 22145924224 },
    { 1009 , 346292032 , 22162702208 },
    { 1010 , 346552768 , 22179476864 },
    { 1011 , 346815424 , 22196255104 },
    { 1012 , 347076544 , 22213031552 },
    { 1013 , 347338688 , 22229810816 },
    { 1014 , 347602624 , 22246584704 },
    { 1015 , 347864896 , 22263361664 },
    { 1016 , 348126656 , 22280142208 },
    { 1017 , 348389312 , 22296919936 },
    { 1018 , 348650944 , 22313696128 },
    { 1019 , 348913216 , 22330473856 },
    { 1020 , 349175488 , 22347250048 },
    { 1021 , 349437248 , 22364027264 },
    { 1022 , 349699648 , 22380804736 },
    { 1023 , 349962176 , 22397581952 },
    { 1024 , 350223296 , 22414359424 },
    { 1025 , 350486336 , 22431136384 },
    { 1026 , 350748224 , 22447913344 },
    { 1027 , 351010112 , 22464689792 },
    { 1028 , 351270848 , 22481468288 },
    { 1029 , 351534784 , 22498239616 },
    { 1030 , 351796672 , 22515023744 },
    { 1031 , 352056256 , 22531800448 },
    { 1032 , 352321472 , 22548574592 },
    { 1033 , 352583104 , 22565355392 },
    { 1034 , 352844992 , 22582132096 },
    { 1035 , 353107904 , 22598901632 },
    { 1036 , 353369152 , 22615686272 },
    { 1037 , 353632064 , 22632462976 },
    { 1038 , 353893184 , 22649236096 },
    { 1039 , 354156224 , 22666018432 },
    { 1040 , 354418496 , 22682793856 },
    { 1041 , 354679616 , 22699572608 },
    { 1042 , 354939712 , 22716350336 },
    { 1043 , 355204672 , 22733126272 },
    { 1044 , 355466816 , 22749904768 },
    { 1045 , 355728448 , 22766681216 },
    { 1046 , 355989824 , 22783457408 },
    { 1047 , 356252224 , 22800236416 },
    { 1048 , 356514112 , 22817013376 },
    { 1049 , 356777152 , 22833789568 },
    { 1050 , 357037888 , 22850564992 },
    { 1051 , 357301696 , 22867342976 },
    { 1052 , 357564352 , 22884118144 },
    { 1053 , 357826496 , 22900898432 },
    { 1054 , 358088512 , 22917670016 },
    { 1055 , 358350656 , 22934452096 },
    { 1056 , 358610624 , 22951228288 },
    { 1057 , 358874176 , 22968007808 },
    { 1058 , 359137216 , 22984783232 },
    { 1059 , 359398976 , 23001560704 },
    { 1060 , 359661376 , 23018338688 },
    { 1061 , 359922496 , 23035117184 },
    { 1062 , 360185792 , 23051892608 },
    { 1063 , 360447424 , 23068671872 },
    { 1064 , 360708928 , 23085448832 },
    { 1065 , 360970432 , 23102221952 },
    { 1066 , 361234112 , 23119002496 },
    { 1067 , 361495744 , 23135772544 },
    { 1068 , 361758016 , 23152557184 },
    { 1069 , 362019776 , 23169331072 },
    { 1070 , 362282432 , 23186110592 },
    { 1071 , 362542784 , 23202888832 },
    { 1072 , 362805056 , 23219662208 },
    { 1073 , 363069376 , 23236442752 },
    { 1074 , 363330368 , 23253220736 },
    { 1075 , 363593024 , 23269996928 },
    { 1076 , 363855424 , 23286773632 },
    { 1077 , 364115776 , 23303551616 },
    { 1078 , 364379584 , 23320330112 },
    { 1079 , 364641856 , 23337106816 },
    { 1080 , 364904128 , 23353881472 },
    { 1081 , 365164736 , 23370659456 },
    { 1082 , 365428288 , 23387437952 },
    { 1083 , 365690816 , 23404210048 },
    { 1084 , 365950528 , 23420992384 },
    { 1085 , 366215104 , 23437770368 },
    { 1086 , 366476224 , 23454541696 },
    { 1087 , 366738752 , 23471325056 },
    { 1088 , 366998848 , 23488101248 },
    { 1089 , 367262144 , 23504879488 },
    { 1090 , 367524928 , 23521647488 },
    { 1091 , 367787072 , 23538431872 },
    { 1092 , 368047808 , 23555207296 },
    { 1093 , 368311232 , 23571988096 },
    { 1094 , 368572352 , 23588763776 },
    { 1095 , 368836544 , 23605536896 },
    { 1096 , 369096256 , 23622319744 },
    { 1097 , 369360832 , 23639093888 },
    { 1098 , 369622336 , 23655873664 },
    { 1099 , 369884864 , 23672651648 },
    { 1100 , 370147264 , 23689422464 },
    { 1101 , 370408768 , 23706205568 },
    { 1102 , 370671424 , 23722981504 },
    { 1103 , 370933568 , 23739756928 },
    { 1104 , 371195584 , 23756533376 },
    { 1105 , 371457472 , 23773314944 },
    { 1106 , 371719232 , 23790088064 },
    { 1107 , 371982272 , 23806868864 },
    { 1108 , 372243392 , 23823644288 },
    { 1109 , 372504896 , 23840422784 },
    { 1110 , 372767936 , 23857201024 },
    { 1111 , 373029952 , 23873977216 },
    { 1112 , 373291456 , 23890754176 },
    { 1113 , 373555136 , 23907529088 },
    { 1114 , 373816384 , 23924309888 },
    { 1115 , 374078912 , 23941083008 },
    { 1116 , 374341568 , 23957861504 },
    { 1117 , 374603072 , 23974638208 },
    { 1118 , 374865856 , 23991416704 },
    { 1119 , 375127744 , 24008192896 },
    { 1120 , 375389888 , 24024969856 },
    { 1121 , 375651904 , 24041746304 },
    { 1122 , 375911104 , 24058526848 },
    { 1123 , 376175168 , 24075301504 },
    { 1124 , 376437184 , 24092081792 },
    { 1125 , 376699712 , 24108856448 },
    { 1126 , 376960832 , 24125635712 },
    { 1127 , 377225152 , 24142411648 },
    { 1128 , 377485376 , 24159190912 },
    { 1129 , 377749312 , 24175966336 },
    { 1130 , 378007744 , 24192745088 },
    { 1131 , 378273472 , 24209522048 },
    { 1132 , 378534976 , 24226299008 },
    { 1133 , 378796736 , 24243074432 },
    { 1134 , 379059904 , 24259847296 },
    { 1135 , 379321792 , 24276629632 },
    { 1136 , 379581632 , 24293406848 },
    { 1137 , 379845952 , 24310183808 },
    { 1138 , 380107456 , 24326961536 },
    { 1139 , 380369984 , 24343735424 },
    { 1140 , 380633024 , 24360517504 },
    { 1141 , 380893376 , 24377292416 },
    { 1142 , 381157312 , 24394070912 },
    { 1143 , 381418432 , 24410849152 },
    { 1144 , 381681472 , 24427624576 },
    { 1145 , 381942464 , 24444403072 },
    { 1146 , 382204864 , 24461180288 },
    { 1147 , 382467136 , 24477957248 },
    { 1148 , 382729664 , 24494734976 },
    { 1149 , 382990912 , 24511511936 },
    { 1150 , 383254208 , 24528288896 },
    { 1151 , 383514944 , 24545066368 },
    { 1152 , 383778496 , 24561839488 },
    { 1153 , 384039616 , 24578619776 },
    { 1154 , 384302656 , 24595396736 },
    { 1155 , 384564032 , 24612174976 },
    { 1156 , 384825536 , 24628951936 },
    { 1157 , 385089344 , 24645728896 },
    { 1158 , 385350976 , 24662507392 },
    { 1159 , 385613632 , 24679283584 },
    { 1160 , 385875136 , 24696055424 },
    { 1161 , 386138048 , 24712838272 },
    { 1162 , 386399296 , 24729612928 },
    { 1163 , 386662208 , 24746388608 },
    { 1164 , 386923456 , 24763170688 },
    { 1165 , 387185984 , 24779944064 },
    { 1166 , 387448384 , 24796724608 },
    { 1167 , 387710528 , 24813501824 },
    { 1168 , 387971392 , 24830273408 },
    { 1169 , 388234432 , 24847054976 },
    { 1170 , 388497344 , 24863829632 },
    { 1171 , 388759232 , 24880609408 },
    { 1172 , 389020864 , 24897387904 },
    { 1173 , 389278528 , 24914165632 },
    { 1174 , 389543872 , 24930942592 },
    { 1175 , 389808064 , 24947714432 },
    { 1176 , 390067648 , 24964496512 },
    { 1177 , 390332224 , 24981271936 },
    { 1178 , 390592448 , 24998048384 },
    { 1179 , 390855616 , 25014828928 },
    { 1180 , 391118656 , 25031604608 },
    { 1181 , 391380928 , 25048383104 },
    { 1182 , 391643072 , 25065159296 },
    { 1183 , 391905088 , 25081937792 },
    { 1184 , 392166976 , 25098714752 },
    { 1185 , 392427712 , 25115490944 },
    { 1186 , 392691008 , 25132264576 },
    { 1187 , 392953664 , 25149046144 },
    { 1188 , 393215936 , 25165822592 },
    { 1189 , 393477824 , 25182597248 },
    { 1190 , 393740224 , 25199377792 },
    { 1191 , 394001984 , 25216150912 },
    { 1192 , 394264384 , 25232930176 },
    { 1193 , 394526656 , 25249709696 },
    { 1194 , 394788032 , 25266486656 },
    { 1195 , 395050688 , 25283262848 },
    { 1196 , 395311808 , 25300034944 },
    { 1197 , 395574208 , 25316816768 },
    { 1198 , 395836096 , 25333596032 },
    { 1199 , 396097984 , 25350371456 },
    { 1200 , 396360512 , 25367149952 },
    { 1201 , 396623296 , 25383927424 },
    { 1202 , 396884672 , 25400699264 },
    { 1203 , 397148096 , 25417480832 },
    { 1204 , 397409728 , 25434259072 },
    { 1205 , 397671488 , 25451035264 },
    { 1206 , 397934144 , 25467813248 },
    { 1207 , 398196416 , 25484588672 },
    { 1208 , 398458688 , 25501365632 },
    { 1209 , 398717248 , 25518142336 },
    { 1210 , 398981696 , 25534914688 },
    { 1211 , 399242944 , 25551696512 },
    { 1212 , 399504832 , 25568472448 },
    { 1213 , 399768256 , 25585251712 },
    { 1214 , 400031552 , 25602030208 },
    { 1215 , 400293056 , 25618803328 },
    { 1216 , 400555328 , 25635585152 },
    { 1217 , 400817728 , 25652361088 },
    { 1218 , 401079872 , 25669140352 },
    { 1219 , 401341888 , 25685916544 },
    { 1220 , 401603392 , 25702692992 },
    { 1221 , 401865664 , 25719471488 },
    { 1222 , 402128576 , 25736249216 },
    { 1223 , 402389056 , 25753026176 },
    { 1224 , 402652736 , 25769799296 },
    { 1225 , 402913216 , 25786580608 },
    { 1226 , 403176128 , 25803356032 },
    { 1227 , 403438912 , 25820130176 },
    { 1228 , 403701184 , 25836910976 },
    { 1229 , 403963072 , 25853687936 },
    { 1230 , 404225984 , 25870464128 },
    { 1231 , 404487488 , 25887240832 },
    { 1232 , 404750272 , 25904019584 },
    { 1233 , 405012416 , 25920797824 },
    { 1234 , 405274432 , 25937575808 },
    { 1235 , 405536192 , 25954351744 },
    { 1236 , 405798208 , 25971129728 },
    { 1237 , 406059968 , 25987899008 },
    { 1238 , 406323136 , 26004684416 },
    { 1239 , 406584128 , 26021458048 },
    { 1240 , 406846912 , 26038237312 },
    { 1241 , 407109056 , 26055015808 },
    { 1242 , 407371072 , 26071793536 },
    { 1243 , 407633216 , 26088566144 },
    { 1244 , 407895232 , 26105347456 },
    { 1245 , 408157888 , 26122125184 },
    { 1246 , 408420032 , 26138900864 },
    { 1247 , 408679616 , 26155677568 },
    { 1248 , 408943936 , 26172456064 },
    { 1249 , 409206208 , 26189234048 },
    { 1250 , 409468736 , 26206009472 },
    { 1251 , 409730624 , 26222786432 },
    { 1252 , 409991872 , 26239565696 },
    { 1253 , 410255168 , 26256339584 },
    { 1254 , 410516032 , 26273118848 },
    { 1255 , 410779456 , 26289894272 },
    { 1256 , 411041216 , 26306672768 },
    { 1257 , 411303232 , 26323451008 },
    { 1258 , 411563968 , 26340227456 },
    { 1259 , 411825472 , 26357003648 },
    { 1260 , 412090304 , 26373782912 },
    { 1261 , 412351936 , 26390560384 },
    { 1262 , 412612672 , 26407336832 },
    { 1263 , 412876096 , 26424113792 },
    { 1264 , 413136832 , 26440892288 },
    { 1265 , 413401024 , 26457666944 },
    { 1266 , 413661632 , 26474442112 },
    { 1267 , 413923648 , 26491223168 },
    { 1268 , 414187328 , 26508000128 },
    { 1269 , 414449344 , 26524776064 },
    { 1270 , 414709184 , 26541552256 },
    { 1271 , 414972736 , 26558332288 },
    { 1272 , 415233472 , 26575107968 },
    { 1273 , 415496896 , 26591887232 },
    { 1274 , 415759808 , 26608660096 },
    { 1275 , 416021696 , 26625441664 },
    { 1276 , 416282816 , 26642217344 },
    { 1277 , 416544704 , 26658994304 },
    { 1278 , 416808512 , 26675771776 },
    { 1279 , 417068992 , 26692548992 },
    { 1280 , 417333184 , 26709327488 },
    { 1281 , 417593024 , 26726104448 },
    { 1282 , 417857344 , 26742882176 },
    { 1283 , 418119232 , 26759656064 },
    { 1284 , 418381504 , 26776432768 },
    { 1285 , 418643776 , 26793209984 },
    { 1286 , 418904384 , 26809990016 },
    { 1287 , 419167552 , 26826768256 },
    { 1288 , 419428928 , 26843545472 },
    { 1289 , 419692352 , 26860322176 },
    { 1290 , 419954624 , 26877099904 },
    { 1291 , 420216128 , 26893876096 },
    { 1292 , 420478144 , 26910651776 },
    { 1293 , 420741056 , 26927426432 },
    { 1294 , 421002944 , 26944207232 },
    { 1295 , 421264576 , 26960983424 },
    { 1296 , 421526848 , 26977761152 },
    { 1297 , 421789504 , 26994540416 },
    { 1298 , 422051776 , 27011317376 },
    { 1299 , 422313536 , 27028094848 },
    { 1300 , 422575168 , 27044871296 },
    { 1301 , 422837696 , 27061648256 },
    { 1302 , 423100096 , 27078424448 },
    { 1303 , 423361984 , 27095198848 },
    { 1304 , 423623104 , 27111978368 },
    { 1305 , 423886784 , 27128757632 },
    { 1306 , 424148416 , 27145534336 },
    { 1307 , 424410944 , 27162310528 },
    { 1308 , 424672832 , 27179086976 },
    { 1309 , 424934464 , 27195867008 },
    { 1310 , 425196736 , 27212642176 },
    { 1311 , 425458624 , 27229417088 },
    { 1312 , 425718848 , 27246196864 },
    { 1313 , 425983808 , 27262972544 },
    { 1314 , 426245824 , 27279749248 },
    { 1315 , 426506816 , 27296527744 },
    { 1316 , 426769472 , 27313307264 },
    { 1317 , 427030976 , 27330082432 },
    { 1318 , 427294144 , 27346859648 },
    { 1319 , 427556288 , 27363638912 },
    { 1320 , 427818176 , 27380416384 },
    { 1321 , 428080448 , 27397193344 },
    { 1322 , 428343232 , 27413969536 },
    { 1323 , 428605376 , 27430748032 },
    { 1324 , 428866496 , 27447524224 },
    { 1325 , 429129152 , 27464299904 },
    { 1326 , 429388864 , 27481077376 },
    { 1327 , 429652672 , 27497856896 },
    { 1328 , 429915712 , 27514628224 },
    { 1329 , 430177472 , 27531410048 },
    { 1330 , 430439104 , 27548181376 },
    { 1331 , 430702528 , 27564964736 },
    { 1332 , 430964672 , 27581742976 },
    { 1333 , 431225792 , 27598518656 },
    { 1334 , 431488192 , 27615297152 },
    { 1335 , 431750464 , 27632072576 },
    { 1336 , 432012992 , 27648844672 },
    { 1337 , 432274496 , 27665626496 },
    { 1338 , 432536128 , 27682406272 },
    { 1339 , 432799424 , 27699182464 },
    { 1340 , 433061312 , 27715959424 },
    { 1341 , 433323712 , 27732737152 },
    { 1342 , 433585088 , 27749510528 },
    { 1343 , 433847104 , 27766292096 },
    { 1344 , 434110016 , 27783069568 },
    { 1345 , 434372416 , 27799846784 },
    { 1346 , 434633536 , 27816622976 },
    { 1347 , 434896832 , 27833400704 },
    { 1348 , 435157952 , 27850178432 },
    { 1349 , 435420224 , 27866955392 },
    { 1350 , 435681472 , 27883729024 },
    { 1351 , 435944896 , 27900508544 },
    { 1352 , 436207424 , 27917286272 },
    { 1353 , 436469056 , 27934063232 },
    { 1354 , 436731712 , 27950837632 },
    { 1355 , 436993472 , 27967616896 },
    { 1356 , 437254592 , 27984394624 },
    { 1357 , 437516864 , 28001168512 },
    { 1358 , 437780032 , 28017947264 },
    { 1359 , 438041792 , 28034726528 },
    { 1360 , 438304576 , 28051501696 },
    { 1361 , 438566848 , 28068280192 },
    { 1362 , 438828608 , 28085057408 },
    { 1363 , 439090112 , 28101836416 },
    { 1364 , 439352384 , 28118612864 },
    { 1365 , 439615424 , 28135391104 },
    { 1366 , 439876544 , 28152163712 },
    { 1367 , 440134976 , 28168944256 },
    { 1368 , 440401216 , 28185721216 },
    { 1369 , 440663744 , 28202498176 },
    { 1370 , 440924992 , 28219274624 },
    { 1371 , 441188288 , 28236050816 },
    { 1372 , 441450176 , 28252831616 },
    { 1373 , 441712192 , 28269606784 },
    { 1374 , 441973568 , 28286385536 },
    { 1375 , 442236736 , 28303163008 },
    { 1376 , 442497344 , 28319938432 },
    { 1377 , 442760128 , 28336716416 },
    { 1378 , 443022784 , 28353494144 },
    { 1379 , 443284544 , 28370271872 },
    { 1380 , 443547584 , 28387044736 },
    { 1381 , 443809088 , 28403825024 },
    { 1382 , 444071872 , 28420601984 },
    { 1383 , 444333632 , 28437379456 },
    { 1384 , 444596032 , 28454155904 },
    { 1385 , 444857152 , 28470933376 },
    { 1386 , 445118528 , 28487709568 },
    { 1387 , 445381952 , 28504487296 },
    { 1388 , 445644736 , 28521263744 },
    { 1389 , 445905472 , 28538040704 },
    { 1390 , 446168896 , 28554821248 },
    { 1391 , 446430784 , 28571598464 },
    { 1392 , 446693056 , 28588364416 },
    { 1393 , 446955328 , 28605153152 },
    { 1394 , 447217216 , 28621927808 },
    { 1395 , 447478208 , 28638707072 },
    { 1396 , 447741248 , 28655484544 },
    { 1397 , 448003904 , 28672261504 },
    { 1398 , 448266176 , 28689036416 },
    { 1399 , 448528064 , 28705814656 },
    { 1400 , 448789568 , 28722592384 },
    { 1401 , 449051968 , 28739368576 },
    { 1402 , 449313856 , 28756143232 },
    { 1403 , 449576128 , 28772924032 },
    { 1404 , 449838016 , 28789702016 },
    { 1405 , 450101056 , 28806479488 },
    { 1406 , 450362944 , 28823255936 },
    { 1407 , 450624704 , 28840032896 },
    { 1408 , 450887104 , 28856811136 },
    { 1409 , 451149632 , 28873587328 },
    { 1410 , 451411648 , 28890365824 },
    { 1411 , 451672384 , 28907141504 },
    { 1412 , 451936064 , 28923916928 },
    { 1413 , 452197184 , 28940697472 },
    { 1414 , 452459968 , 28957473152 },
    { 1415 , 452722496 , 28974251392 },
    { 1416 , 452984512 , 28991026304 },
    { 1417 , 453246272 , 29007802496 },
    { 1418 , 453508288 , 29024583296 },
    { 1419 , 453770816 , 29041358464 },
    { 1420 , 454032064 , 29058137728 },
    { 1421 , 454294592 , 29074911104 },
    { 1422 , 454557632 , 29091689344 },
    { 1423 , 454819136 , 29108468608 },
    { 1424 , 455081408 , 29125245824 },
    { 1425 , 455342912 , 29142018688 },
    { 1426 , 455603648 , 29158800256 },
    { 1427 , 455864768 , 29175577472 },
    { 1428 , 456130496 , 29192350592 },
    { 1429 , 456392512 , 29209131136 },
    { 1430 , 456654656 , 29225903744 },
    { 1431 , 456916672 , 29242685312 },
    { 1432 , 457178944 , 29259463808 },
    { 1433 , 457440448 , 29276241536 },
    { 1434 , 457702976 , 29293014656 },
    { 1435 , 457963328 , 29309795456 },
    { 1436 , 458227136 , 29326573184 },
    { 1437 , 458487872 , 29343347584 },
    { 1438 , 458751424 , 29360124544 },
    { 1439 , 459013952 , 29376900736 },
    { 1440 , 459275584 , 29393681024 },
    { 1441 , 459537856 , 29410457984 },
    { 1442 , 459800512 , 29427236224 },
    { 1443 , 460061248 , 29444011904 },
    { 1444 , 460324672 , 29460790144 },
    { 1445 , 460586176 , 29477567104 },
    { 1446 , 460848832 , 29494344832 },
    { 1447 , 461111104 , 29511122048 },
    { 1448 , 461372864 , 29527897216 },
    { 1449 , 461634112 , 29544677248 },
    { 1450 , 461897536 , 29561454464 },
    { 1451 , 462156736 , 29578228352 },
    { 1452 , 462420928 , 29595008896 },
    { 1453 , 462682816 , 29611786112 },
    { 1454 , 462945856 , 29628563072 },
    { 1455 , 463207744 , 29645337472 },
    { 1456 , 463470272 , 29662116992 },
    { 1457 , 463731776 , 29678893184 },
    { 1458 , 463994816 , 29695672192 },
    { 1459 , 464256704 , 29712449152 },
    { 1460 , 464518976 , 29729222272 },
    { 1461 , 464780864 , 29746003328 },
    { 1462 , 465043136 , 29762780288 },
    { 1463 , 465305024 , 29779554176 },
    { 1464 , 465567296 , 29796335488 },
    { 1465 , 465829568 , 29813111936 },
    { 1466 , 466091456 , 29829887872 },
    { 1467 , 466353856 , 29846662784 },
    { 1468 , 466615232 , 29863443328 },
    { 1469 , 466876736 , 29880221312 },
    { 1470 , 467139136 , 29896998016 },
    { 1471 , 467402176 , 29913771392 },
    { 1472 , 467663296 , 29930551936 },
    { 1473 , 467926336 , 29947326848 },
    { 1474 , 468188608 , 29964105088 },
    { 1475 , 468451264 , 29980883584 },
    { 1476 , 468713408 , 29997660544 },
    { 1477 , 468974144 , 30014439296 },
    { 1478 , 469237696 , 30031210624 },
    { 1479 , 469499584 , 30047989376 },
    { 1480 , 469760576 , 30064769408 },
    { 1481 , 470023744 , 30081547136 },
    { 1482 , 470285632 , 30098324864 },
    { 1483 , 470547136 , 30115101824 },
    { 1484 , 470810176 , 30131879552 },
    { 1485 , 471072064 , 30148655744 },
    { 1486 , 471333952 , 30165433472 },
    { 1487 , 471596096 , 30182210944 },
    { 1488 , 471856192 , 30198986624 },
    { 1489 , 472120256 , 30215761024 },
    { 1490 , 472382912 , 30232542848 },
    { 1491 , 472645312 , 30249318784 },
    { 1492 , 472907584 , 30266096768 },
    { 1493 , 473169856 , 30282860672 },
    { 1494 , 473430592 , 30299650688 },
    { 1495 , 473690432 , 30316428416 },
    { 1496 , 473955008 , 30333205888 },
    { 1497 , 474216256 , 30349982336 },
    { 1498 , 474479168 , 30366760064 },
    { 1499 , 474742592 , 30383533952 },
    { 1500 , 475003072 , 30400314496 },
    { 1501 , 475266496 , 30417091456 },
    { 1502 , 475529024 , 30433864064 },
    { 1503 , 475790272 , 30450645376 },
    { 1504 , 476053184 , 30467419264 },
    { 1505 , 476315584 , 30484194688 },
    { 1506 , 476575168 , 30500978048 },
    { 1507 , 476838976 , 30517755776 },
    { 1508 , 477100864 , 30534532736 },
    { 1509 , 477363776 , 30551309696 },
    { 1510 , 477626048 , 30568079744 },
    { 1511 , 477887296 , 30584860288 },
    { 1512 , 478150336 , 30601641856 },
    { 1513 , 478412608 , 30618419072 },
    { 1514 , 478674496 , 30635195264 },
    { 1515 , 478937024 , 30651968896 },
    { 1516 , 479196992 , 30668749952 },
    { 1517 , 479459776 , 30685526656 },
    { 1518 , 479723456 , 30702303872 },
    { 1519 , 479985472 , 30719079808 },
    { 1520 , 480247616 , 30735859328 },
    { 1521 , 480509888 , 30752636032 },
    { 1522 , 480771008 , 30769412224 },
    { 1523 , 481033664 , 30786190976 },
    { 1524 , 481294144 , 30802963328 },
    { 1525 , 481557952 , 30819744128 },
    { 1526 , 481817792 , 30836521088 },
    { 1527 , 482082368 , 30853300096 },
    { 1528 , 482344768 , 30870077312 },
    { 1529 , 482606144 , 30886854016 },
    { 1530 , 482868928 , 30903630976 },
    { 1531 , 483130688 , 30920408192 },
    { 1532 , 483393088 , 30937184896 },
    { 1533 , 483655232 , 30953961856 },
    { 1534 , 483917248 , 30970735232 },
    { 1535 , 484179392 , 30987513472 },
    { 1536 , 484440896 , 31004294528 },
    { 1537 , 484702784 , 31021070464 },
    { 1538 , 484965952 , 31037847424 },
    { 1539 , 485227712 , 31054623616 },
    { 1540 , 485490496 , 31071400576 },
    { 1541 , 485751488 , 31088176256 },
    { 1542 , 486014912 , 31104958336 },
    { 1543 , 486276928 , 31121734016 },
    { 1544 , 486537664 , 31138512256 },
    { 1545 , 486801344 , 31155289472 },
    { 1546 , 487063232 , 31172061056 },
    { 1547 , 487325632 , 31188840064 },
    { 1548 , 487587136 , 31205620352 },
    { 1549 , 487848896 , 31222397056 },
    { 1550 , 488111552 , 31239174784 },
    { 1551 , 488373056 , 31255951744 },
    { 1552 , 488635712 , 31272727936 },
    { 1553 , 488897984 , 31289507456 },
    { 1554 , 489160384 , 31306283648 },
    { 1555 , 489422272 , 31323059072 },
    { 1556 , 489682496 , 31339838848 },
    { 1557 , 489946432 , 31356616576 },
    { 1558 , 490209088 , 31373393024 },
    { 1559 , 490468288 , 31390159744 },
    { 1560 , 490733504 , 31406947456 },
    { 1561 , 490995136 , 31423725184 },
    { 1562 , 491255872 , 31440502144 },
    { 1563 , 491519552 , 31457279872 },
    { 1564 , 491781824 , 31474050688 },
    { 1565 , 492044096 , 31490832512 },
    { 1566 , 492306368 , 31507610752 },
    { 1567 , 492567616 , 31524387712 },
    { 1568 , 492830656 , 31541163392 },
    { 1569 , 493091776 , 31557943168 },
    { 1570 , 493354816 , 31574720384 },
    { 1571 , 493617088 , 31591497088 },
    { 1572 , 493878208 , 31608274304 },
    { 1573 , 494141248 , 31625051776 },
    { 1574 , 494402752 , 31641828992 },
    { 1575 , 494665664 , 31658605952 },
    { 1576 , 494926912 , 31675383424 },
    { 1577 , 495189824 , 31692160384 },
    { 1578 , 495451328 , 31708934528 },
    { 1579 , 495708608 , 31725714304 },
    { 1580 , 495975104 , 31742490496 },
    { 1581 , 496235456 , 31759263104 },
    { 1582 , 496499776 , 31776046208 },
    { 1583 , 496762688 , 31792823168 },
    { 1584 , 497024576 , 31809600896 },
    { 1585 , 497286976 , 31826373248 },
    { 1586 , 497548864 , 31843154048 },
    { 1587 , 497810624 , 31859929984 },
    { 1588 , 498072128 , 31876701056 },
    { 1589 , 498333632 , 31893487232 },
    { 1590 , 498597824 , 31910263936 },
    { 1591 , 498857152 , 31927040896 },
    { 1592 , 499122112 , 31943818624 },
    { 1593 , 499383616 , 31960591744 },
    { 1594 , 499646272 , 31977372032 },
    { 1595 , 499907776 , 31994150528 },
    { 1596 , 500170432 , 32010927232 },
    { 1597 , 500431552 , 32027702144 },
    { 1598 , 500694848 , 32044481408 },
    { 1599 , 500955968 , 32061257344 },
    { 1600 , 501217088 , 32078036608 },
    { 1601 , 501481408 , 32094813568 },
    { 1602 , 501742784 , 32111591296 },
    { 1603 , 502004416 , 32128364672 },
    { 1604 , 502267328 , 32145145216 },
    { 1605 , 502528064 , 32161922944 },
    { 1606 , 502789696 , 32178698624 },
    { 1607 , 503053888 , 32195476864 },
    { 1608 , 503315264 , 32212253056 },
    { 1609 , 503576384 , 32229031552 },
    { 1610 , 503836352 , 32245806464 },
    { 1611 , 504102848 , 32262583424 },
    { 1612 , 504364352 , 32279362432 },
    { 1613 , 504623296 , 32296139648 },
    { 1614 , 504888512 , 32312908928 },
    { 1615 , 505149248 , 32329691776 },
    { 1616 , 505412032 , 32346472064 },
    { 1617 , 505675712 , 32363248768 },
    { 1618 , 505937728 , 32380022912 },
    { 1619 , 506198848 , 32396793472 },
    { 1620 , 506461888 , 32413577344 },
    { 1621 , 506723648 , 32430358144 },
    { 1622 , 506984384 , 32447134336 },
    { 1623 , 507248576 , 32463910016 },
    { 1624 , 507509312 , 32480690048 },
    { 1625 , 507771328 , 32497467008 },
    { 1626 , 508034624 , 32514238336 },
    { 1627 , 508295488 , 32531021696 },
    { 1628 , 508558912 , 32547798656 },
    { 1629 , 508820288 , 32564573824 },
    { 1630 , 509083072 , 32581353344 },
    { 1631 , 509345728 , 32598130304 },
    { 1632 , 509606848 , 32614906496 },
    { 1633 , 509868992 , 32631684224 },
    { 1634 , 510131264 , 32648458624 },
    { 1635 , 510393536 , 32665238912 },
    { 1636 , 510654784 , 32682015616 },
    { 1637 , 510915136 , 32698792832 },
    { 1638 , 511176896 , 32715569792 },
    { 1639 , 511440448 , 32732348288 },
    { 1640 , 511705024 , 32749121408 },
    { 1641 , 511967168 , 32765900416 },
    { 1642 , 512228672 , 32782673024 },
    { 1643 , 512491456 , 32799455872 },
    { 1644 , 512752832 , 32816233088 },
    { 1645 , 513015488 , 32833011584 },
    { 1646 , 513277504 , 32849788544 },
    { 1647 , 513540032 , 32866565504 },
    { 1648 , 513801664 , 32883336064 },
    { 1649 , 514063808 , 32900119936 },
    { 1650 , 514325824 , 32916894592 },
    { 1651 , 514588352 , 32933674112 },
    { 1652 , 514849856 , 32950451584 },
    { 1653 , 515112896 , 32967228544 },
    { 1654 , 515374784 , 32984005504 },
    { 1655 , 515636672 , 33000781952 },
    { 1656 , 515897024 , 33017560448 },
    { 1657 , 516160576 , 33034337152 },
    { 1658 , 516423616 , 33051114368 },
    { 1659 , 516684992 , 33067892608 },
    { 1660 , 516945344 , 33084669824 },
    { 1661 , 517209536 , 33101443456 },
    { 1662 , 517472192 , 33118216832 },
    { 1663 , 517734208 , 33135001472 },
    { 1664 , 517996096 , 33151776128 },
    { 1665 , 518257856 , 33168552064 },
    { 1666 , 518519744 , 33185329792 },
    { 1667 , 518782912 , 33202107776 },
    { 1668 , 519042752 , 33218886784 },
    { 1669 , 519305536 , 33235664512 },
    { 1670 , 519568064 , 33252437888 },
    { 1671 , 519830848 , 33269217152 },
    { 1672 , 520092992 , 33285996416 },
    { 1673 , 520355392 , 33302771584 },
    { 1674 , 520616896 , 33319550848 },
    { 1675 , 520879808 , 33336327296 },
    { 1676 , 521141696 , 33353105024 },
    { 1677 , 521403968 , 33369881728 },
    { 1678 , 521665472 , 33386655616 },
    { 1679 , 521926336 , 33403435904 },
    { 1680 , 522190016 , 33420212864 },
    { 1681 , 522452416 , 33436989056 },
    { 1682 , 522714176 , 33453768064 },
    { 1683 , 522977216 , 33470541952 },
    { 1684 , 523236928 , 33487316608 },
    { 1685 , 523500352 , 33504098176 },
    { 1686 , 523763648 , 33520875904 },
    { 1687 , 524024768 , 33537651584 },
    { 1688 , 524287424 , 33554429056 },
    { 1689 , 524548928 , 33571208576 },
    { 1690 , 524811712 , 33587982976 },
    { 1691 , 525073984 , 33604760192 },
    { 1692 , 525336512 , 33621538432 },
    { 1693 , 525598144 , 33638310016 },
    { 1694 , 525860672 , 33655094912 },
    { 1695 , 526121536 , 33671869568 },
    { 1696 , 526384832 , 33688648064 },
    { 1697 , 526647232 , 33705425024 },
    { 1698 , 526908992 , 33722203264 },
    { 1699 , 527169856 , 33738980992 },
    { 1700 , 527433152 , 33755758208 },
    { 1701 , 527695552 , 33772533376 },
    { 1702 , 527957312 , 33789312896 },
    { 1703 , 528219584 , 33806087552 },
    { 1704 , 528481984 , 33822866816 },
    { 1705 , 528743744 , 33839642752 },
    { 1706 , 529005632 , 33856421504 },
    { 1707 , 529268416 , 33873196928 },
    { 1708 , 529529536 , 33889965952 },
    { 1709 , 529792832 , 33906753152 },
    { 1710 , 530054848 , 33923523968 },
    { 1711 , 530316992 , 33940305536 },
    { 1712 , 530579008 , 33957081472 },
    { 1713 , 530840384 , 33973854592 },
    { 1714 , 531103168 , 33990633856 },
    { 1715 , 531365696 , 34007415424 },
    { 1716 , 531627968 , 34024191616 },
    { 1717 , 531889984 , 34040971136 },
    { 1718 , 532151744 , 34057746304 },
    { 1719 , 532414144 , 34074521984 },
    { 1720 , 532676416 , 34091302016 },
    { 1721 , 532936256 , 34108078208 },
    { 1722 , 533200832 , 34124853376 },
    { 1723 , 533461568 , 34141629056 },
    { 1724 , 533724992 , 34158403712 },
    { 1725 , 533985856 , 34175186048 },
    { 1726 , 534246976 , 34191965824 },
    { 1727 , 534510784 , 34208742784 },
    { 1728 , 534772928 , 34225510784 },
    { 1729 , 535035712 , 34242297728 },
    { 1730 , 535297472 , 34259073664 },
    { 1731 , 535559872 , 34275851392 },
    { 1732 , 535822016 , 34292624512 },
    { 1733 , 536083648 , 34309403776 },
    { 1734 , 536345792 , 34326181504 },
    { 1735 , 536608192 , 34342957952 },
    { 1736 , 536869952 , 34359731072 },
    { 1737 , 537132352 , 34376513152 },
    { 1738 , 537395008 , 34393291904 },
    { 1739 , 537656512 , 34410068096 },
    { 1740 , 537918016 , 34426845568 },
    { 1741 , 538180672 , 34443624064 },
    { 1742 , 538442048 , 34460395136 },
    { 1743 , 538705472 , 34477178752 },
    { 1744 , 538960064 , 34493953664 },
    { 1745 , 539228992 , 34510722944 },
    { 1746 , 539490496 , 34527508864 },
    { 1747 , 539754304 , 34544283776 },
    { 1748 , 540014912 , 34561063808 },
    { 1749 , 540277568 , 34577842048 },
    { 1750 , 540540736 , 34594616192 },
    { 1751 , 540801344 , 34611396224 },
    { 1752 , 541065152 , 34628170112 },
    { 1753 , 541324352 , 34644949888 },
    { 1754 , 541589056 , 34661727616 },
    { 1755 , 541851584 , 34678501504 },
    { 1756 , 542112448 , 34695281024 },
    { 1757 , 542375872 , 34712057728 },
    { 1758 , 542638016 , 34728835712 },
    { 1759 , 542899648 , 34745609344 },
    { 1760 , 543161792 , 34762385792 },
    { 1761 , 543424064 , 34779163264 },
    { 1762 , 543686464 , 34795942528 },
    { 1763 , 543948352 , 34812719488 },
    { 1764 , 544210496 , 34829497984 },
    { 1765 , 544471744 , 34846275712 },
    { 1766 , 544733248 , 34863053696 },
    { 1767 , 544995904 , 34879831424 },
    { 1768 , 545257408 , 34896609152 },
    { 1769 , 545521472 , 34913381504 },
    { 1770 , 545783488 , 34930163584 },
    { 1771 , 546044608 , 34946938496 },
    { 1772 , 546306752 , 34963716992 },
    { 1773 , 546569152 , 34980485248 },
    { 1774 , 546832192 , 34997272192 },
    { 1775 , 547093696 , 35014047104 },
    { 1776 , 547356352 , 35030824832 },
    { 1777 , 547617472 , 35047604096 },
    { 1778 , 547880512 , 35064377984 },
    { 1779 , 548142656 , 35081157248 },
    { 1780 , 548404672 , 35097934208 },
    { 1781 , 548665792 , 35114709632 },
    { 1782 , 548929088 , 35131489408 },
    { 1783 , 549191488 , 35148262784 },
    { 1784 , 549453376 , 35165043328 },
    { 1785 , 549715136 , 35181821824 },
    { 1786 , 549977024 , 35198598784 },
    { 1787 , 550238272 , 35215374976 },
    { 1788 , 550501568 , 35232151424 },
    { 1789 , 550764224 , 35248930688 },
    { 1790 , 551026624 , 35265701248 },
    { 1791 , 551288768 , 35282483072 },
    { 1792 , 551548736 , 35299259264 },
    { 1793 , 551812544 , 35316039296 },
    { 1794 , 552074816 , 35332813696 },
    { 1795 , 552337216 , 35349589888 },
    { 1796 , 552598976 , 35366362496 },
    { 1797 , 552861632 , 35383147648 },
    { 1798 , 553122112 , 35399925632 },
    { 1799 , 553382848 , 35416698752 },
    { 1800 , 553646528 , 35433476224 },
    { 1801 , 553909696 , 35450253184 },
    { 1802 , 554172352 , 35467032704 },
    { 1803 , 554433472 , 35483810176 },
    { 1804 , 554695744 , 35500588672 },
    { 1805 , 554958784 , 35517364864 },
    { 1806 , 555220928 , 35534141312 },
    { 1807 , 555481408 , 35550919808 },
    { 1808 , 555745088 , 35567694464 },
    { 1809 , 556006592 , 35584474496 },
    { 1810 , 556268096 , 35601250688 },
    { 1811 , 556531648 , 35618028928 },
    { 1812 , 556793152 , 35634802048 },
    { 1813 , 557054144 , 35651583104 },
    { 1814 , 557317952 , 35668356736 },
    { 1815 , 557579584 , 35685137024 },
    { 1816 , 557842112 , 35701915264 },
    { 1817 , 558102208 , 35718692224 },
    { 1818 , 558366656 , 35735469184 },
    { 1819 , 558628544 , 35752246144 },
    { 1820 , 558889792 , 35769023872 },
    { 1821 , 559150528 , 35785798784 },
    { 1822 , 559414976 , 35802577024 },
    { 1823 , 559676864 , 35819353984 },
    { 1824 , 559939136 , 35836133248 },
    { 1825 , 560201536 , 35852910208 },
    { 1826 , 560462272 , 35869681024 },
    { 1827 , 560725696 , 35886464384 },
    { 1828 , 560987968 , 35903239552 },
    { 1829 , 561249856 , 35920015744 },
    { 1830 , 561511616 , 35936796032 },
    { 1831 , 561774272 , 35953561472 },
    { 1832 , 562035008 , 35970337664 },
    { 1833 , 562298432 , 35987128192 },
    { 1834 , 562560448 , 36003905408 },
    { 1835 , 562821568 , 36020681344 },
    { 1836 , 563084864 , 36037457536 },
    { 1837 , 563346496 , 36054235264 },
    { 1838 , 563609152 , 36071014016 },
    { 1839 , 563871424 , 36087790208 },
    { 1840 , 564132928 , 36104567936 },
    { 1841 , 564395584 , 36121342592 },
    { 1842 , 564657088 , 36138123136 },
    { 1843 , 564920128 , 36154895488 },
    { 1844 , 565181504 , 36171675776 },
    { 1845 , 565441472 , 36188452736 },
    { 1846 , 565705024 , 36205228672 },
    { 1847 , 565963712 , 36222008192 },
    { 1848 , 566230976 , 36238786432 },
    { 1849 , 566492096 , 36255563392 },
    { 1850 , 566754368 , 36272340352 },
    { 1851 , 567016768 , 36289116544 },
    { 1852 , 567276992 , 36305893504 },
    { 1853 , 567539008 , 36322668416 },
    { 1854 , 567803584 , 36339448448 },
    { 1855 , 568064192 , 36356223104 },
    { 1856 , 568326848 , 36373003904 },
    { 1857 , 568587328 , 36389780864 },
    { 1858 , 568851776 , 36406558336 },
    { 1859 , 569114176 , 36423335296 },
    { 1860 , 569376448 , 36440110976 },
    { 1861 , 569638592 , 36456889984 },
    { 1862 , 569900224 , 36473666176 },
    { 1863 , 570162752 , 36490443904 },
    { 1864 , 570424768 , 36507220352 },
    { 1865 , 570686528 , 36523998592 },
    { 1866 , 570948544 , 36540775552 },
    { 1867 , 571211584 , 36557551232 },
    { 1868 , 571472192 , 36574328704 },
    { 1869 , 571735616 , 36591107456 },
    { 1870 , 571997248 , 36607882112 },
    { 1871 , 572259392 , 36624660608 },
    { 1872 , 572522432 , 36641437568 },
    { 1873 , 572784448 , 36658216576 },
    { 1874 , 573046592 , 36674991488 },
    { 1875 , 573306688 , 36691769984 },
    { 1876 , 573570496 , 36708546944 },
    { 1877 , 573832768 , 36725321344 },
    { 1878 , 574094656 , 36742102912 },
    { 1879 , 574353856 , 36758879104 },
    { 1880 , 574616384 , 36775654016 },
    { 1881 , 574881344 , 36792434048 },
    { 1882 , 575140672 , 36809209984 },
    { 1883 , 575406016 , 36825988736 },
    { 1884 , 575665984 , 36842763904 },
    { 1885 , 575929664 , 36859537024 },
    { 1886 , 576191552 , 36876320128 },
    { 1887 , 576453568 , 36893097856 },
    { 1888 , 576715712 , 36909872768 },
    { 1889 , 576978112 , 36926651264 },
    { 1890 , 577239232 , 36943428992 },
    { 1891 , 577502656 , 36960202624 },
    { 1892 , 577763776 , 36976980608 },
    { 1893 , 578026048 , 36993759872 },
    { 1894 , 578289344 , 37010536064 },
    { 1895 , 578550848 , 37027312768 },
    { 1896 , 578813888 , 37044089728 },
    { 1897 , 579075136 , 37060867456 },
    { 1898 , 579338176 , 37077645952 },
    { 1899 , 579599168 , 37094419328 },
    { 1900 , 579862336 , 37111198336 },
    { 1901 , 580124224 , 37127970944 },
    { 1902 , 580386496 , 37144750208 },
    { 1903 , 580648384 , 37161533312 },
    { 1904 , 580910912 , 37178308736 },
    { 1905 , 581173184 , 37195085696 },
    { 1906 , 581433536 , 37211857792 },
    { 1907 , 581697344 , 37228641664 },
    { 1908 , 581958976 , 37245418624 },
    { 1909 , 582220864 , 37262196352 },
    { 1910 , 582482752 , 37278972032 },
    { 1911 , 582744128 , 37295744896 },
    { 1912 , 583006912 , 37312528256 },
    { 1913 , 583269952 , 37329296768 },
    { 1914 , 583531456 , 37346080384 },
    { 1915 , 583794368 , 37362856576 },
    { 1916 , 584056768 , 37379634304 },
    { 1917 , 584318656 , 37396410496 },
    { 1918 , 584580928 , 37413187712 },
    { 1919 , 584842816 , 37429967488 },
    { 1920 , 585102656 , 37446745472 },
    { 1921 , 585366976 , 37463522944 },
    { 1922 , 585629504 , 37480298368 },
    { 1923 , 585891392 , 37497075328 },
    { 1924 , 586153664 , 37513849216 },
    { 1925 , 586415296 , 37530631552 },
    { 1926 , 586678208 , 37547408512 },
    { 1927 , 586939456 , 37564183936 },
    { 1928 , 587202368 , 37580961664 },
    { 1929 , 587464256 , 37597737088 },
    { 1930 , 587725888 , 37614517888 },
    { 1931 , 587988032 , 37631293312 },
    { 1932 , 588251072 , 37648066432 },
    { 1933 , 588513088 , 37664845952 },
    { 1934 , 588773056 , 37681626496 },
    { 1935 , 589037248 , 37698402688 },
    { 1936 , 589298368 , 37715179648 },
    { 1937 , 589560896 , 37731957632 },
    { 1938 , 589822144 , 37748735872 },
    { 1939 , 590085952 , 37765504384 },
    { 1940 , 590348224 , 37782290048 },
    { 1941 , 590610368 , 37799064704 },
    { 1942 , 590872384 , 37815843712 },
    { 1943 , 591134528 , 37832621696 },
    { 1944 , 591393472 , 37849391488 },
    { 1945 , 591658688 , 37866174848 },
    { 1946 , 591920704 , 37882950016 },
    { 1947 , 592183232 , 37899727744 },
    { 1948 , 592445248 , 37916499584 },
    { 1949 , 592706624 , 37933283456 },
    { 1950 , 592969408 , 37950061696 },
    { 1951 , 593231552 , 37966838912 },
    { 1952 , 593492672 , 37983614848 },
    { 1953 , 593754944 , 38000393344 },
    { 1954 , 594017728 , 38017171072 },
    { 1955 , 594279232 , 38033940352 },
    { 1956 , 594538432 , 38050725248 },
    { 1957 , 594804416 , 38067501952 },
    { 1958 , 595066048 , 38084279936 },
    { 1959 , 595328192 , 38101049984 },
    { 1960 , 595590208 , 38117829248 },
    { 1961 , 595851968 , 38134611584 },
    { 1962 , 596115392 , 38151387776 },
    { 1963 , 596377024 , 38168166272 },
    { 1964 , 596639552 , 38184938368 },
    { 1965 , 596900672 , 38201711488 },
    { 1966 , 597163456 , 38218497664 },
    { 1967 , 597425344 , 38235273344 },
    { 1968 , 597687232 , 38252051072 },
    { 1969 , 597948608 , 38268829568 },
    { 1970 , 598212544 , 38285604736 },
    { 1971 , 598474432 , 38302381952 },
    { 1972 , 598735936 , 38319160448 },
    { 1973 , 598998592 , 38335937408 },
    { 1974 , 599260352 , 38352715136 },
    { 1975 , 599522752 , 38369489792 },
    { 1976 , 599784256 , 38386269056 },
    { 1977 , 600047296 , 38403047296 },
    { 1978 , 600309056 , 38419824512 },
    { 1979 , 600568768 , 38436597376 },
    { 1980 , 600833984 , 38453378176 },
    { 1981 , 601093312 , 38470155904 },
    { 1982 , 601357376 , 38486926208 },
    { 1983 , 601617728 , 38503709824 },
    { 1984 , 601881536 , 38520486272 },
    { 1985 , 602139712 , 38537264768 },
    { 1986 , 602406592 , 38554041728 },
    { 1987 , 602668096 , 38570814592 },
    { 1988 , 602930752 , 38587596416 },
    { 1989 , 603191872 , 38604373376 },
    { 1990 , 603455296 , 38621146496 },
    { 1991 , 603717568 , 38637924992 },
    { 1992 , 603979456 , 38654704768 },
    { 1993 , 604240576 , 38671480448 },
    { 1994 , 604502848 , 38688259712 },
    { 1995 , 604766144 , 38705034112 },
    { 1996 , 605027776 , 38721804416 },
    { 1997 , 605288384 , 38738586496 },
    { 1998 , 605550656 , 38755368832 },
    { 1999 , 605813696 , 38772146048 },
    { 2000 , 606076096 , 38788922752 },
    { 2001 , 606338624 , 38805698432 },
    { 2002 , 606601024 , 38822475904 },
    { 2003 , 606862016 , 38839252352 },
    { 2004 , 607125184 , 38856032128 },
    { 2005 , 607387072 , 38872803712 },
    { 2006 , 607649344 , 38889586048 },
    { 2007 , 607911872 , 38906363264 },
    { 2008 , 608172608 , 38923139456 },
    { 2009 , 608436032 , 38939913088 },
    { 2010 , 608698304 , 38956694144 },
    { 2011 , 608958656 , 38973471872 },
    { 2012 , 609220672 , 38990248832 },
    { 2013 , 609483712 , 39007026304 },
    { 2014 , 609745984 , 39023803264 },
    { 2015 , 610008128 , 39040579712 },
    { 2016 , 610270016 , 39057356672 },
    { 2017 , 610533184 , 39074135168 },
    { 2018 , 610795072 , 39090912128 },
    { 2019 , 611056064 , 39107690368 },
    { 2020 , 611317568 , 39124465024 },
    { 2021 , 611580352 , 39141243776 },
    { 2022 , 611843264 , 39158021248 },
    { 2023 , 612105152 , 39174796928 },
    { 2024 , 612366016 , 39191576192 },
    { 2025 , 612626752 , 39208353664 },
    { 2026 , 612892352 , 39225130624 },
    { 2027 , 613153472 , 39241906048 },
    { 2028 , 613416896 , 39258680704 },
    { 2029 , 613678528 , 39275461504 },
    { 2030 , 613940032 , 39292233856 },
    { 2031 , 614203328 , 39309014144 },
    { 2032 , 614464832 , 39325791104 },
    { 2033 , 614727488 , 39342564736 },
    { 2034 , 614988992 , 39359341696 },
    { 2035 , 615251264 , 39376125056 },
    { 2036 , 615511744 , 39392900224 },
    { 2037 , 615776192 , 39409679744 },
    { 2038 , 616037824 , 39426453632 },
    { 2039 , 616300352 , 39443234176 },
    { 2040 , 616562368 , 39460010368 },
    { 2041 , 616824256 , 39476788352 },
    { 2042 , 617086784 , 39493564288 },
    { 2043 , 617349056 , 39510342272 },
    { 2044 , 617610944 , 39527118976 },
    { 2045 , 617872832 , 39543897728 },
    { 2046 , 618135104 , 39560673664 },
    { 2047 , 618396736 , 39577452416 },
    { 10240 , 2766140864 , 177033178496 },
    { 10241 , 0 , 0 },
    { 10242 , 0 , 0 },
    {-1, 0, 0},
};

TEST(ethash, light_cache_size)
{
    for (const auto& t : dataset_size_test_cases)
    {
        int num_items = calculate_light_cache_num_items(t.epoch_number);
        size_t size = get_light_cache_size(num_items);
        EXPECT_EQ(size, t.light_cache_size) << "epoch: " << t.epoch_number;
    }
}

TEST(ethash, full_dataset_size)
{
    for (const auto& t : dataset_size_test_cases)
    {
        const int num_items = calculate_full_dataset_num_items(t.epoch_number);
        const uint64_t size = get_full_dataset_size(num_items);
        EXPECT_EQ(size, t.full_dataset_size) << "epoch: " << t.epoch_number;
    }
}


struct epoch_seed_test_case
{
    const int epoch_number;
    const char* const epoch_seed_hex;
};

/*constexpr epoch_seed_test_case epoch_seed_test_cases[] = {
    {0, "0000000000000000000000000000000000000000000000000000000000000000"},
    {1, "290decd9548b62a8d60345a988386fc84ba6bc95484008f6362f93160ef3e563"},
    {171, "a9b0e0c9aca72c07ba06b5bbdae8b8f69e61878301508473379bb4f71807d707"},
    {2048, "20a7678ca7b50829183baac2e1e3c43fa3c4bcbc171b11cf5a9f30bebd172920"},
    {29998, "1222b1faed7f93098f8ae498621fb3479805a664b70186063861c46596c66164"},
    {29999, "ee1d0f61b054dff0f3025ebba821d405c8dc19a983e582e9fa5436fc3e7a07d8"},
    {max_epoch_number - 1, "9472a82f992649315e3977120843a5a246e375715bd70ee98b3dd77c63154e99"},
    {max_epoch_number, "09b435f2d92d0ddee038c379be8db1f895c904282e9ceb790f519a6aa3f83810"},
};*/

constexpr epoch_seed_test_case epoch_seed_test_cases[] = {
    { 0 , "022fecb1efdedbfc2274ba6694b6eccb38c87bc33d255cbbc999e0580120a305"},
    { 1 , "58e18b2e05b31e5660dc9a38c088707631aa320158e8a0fe4eab1b2cff574c07"},
    { 2 , "0179024ee4452c9c8ff919bb13dedcf19c663d2f79c970327916660ca0faa175"},
    { 10 , "ac3e832cac58a403c02405807d0ab88e689a86b2093c2726ea3351760865838b"},
    { 11 , "ba9bd53e619239aeca5185f25bac4d68cb481c3f1f87e2c34aa8afaa59ba69ac"},
    { 101 , "e3f549b006bb30c632167af69ed252efffa0207db2f3822d662b4885c6e8933e"},
    { 102 , "b2633202bac4893b6533761c598ee8643b77940cc46a9bff049356845d43f3d8"},
    { 2047 , "075435c02fc0a1173107c5444e4ddc3c5a9c8acb747809bb5e1c6b3dd17c95b0"},
    { 2048 , "3f4511fee0da5fa779d999802d11849a3b5d5d143997425de05838c796bbb8c6"},
    { 2049 , "58afaaa51f76f3362abad80f5588efea715b941497284e82f9eb726e1c45d3b4"},
    { 10239 , "c5b3636cdffdaa637b8c14e93ade33af8869023e916e9ce6fe8a1db4009e1f56"},
    { 10240 , "1b70271f10caec30fd1ace432393f50eacd1c242589658fd419cf53328f533c7"},
};

TEST(ethash, calculate_epoch_seed)
{
    for (auto& t : epoch_seed_test_cases)
    {
        const hash256 epoch_seed = calculate_epoch_seed(t.epoch_number);
        EXPECT_EQ(to_hex(epoch_seed), t.epoch_seed_hex);
    }
}


TEST(ethash, find_epoch_number_double_ascending)
{
//    const hash256 seed_29998 = to_hash256(epoch_seed_test_cases[4].epoch_seed_hex);
//    const hash256 seed_29999 = to_hash256(epoch_seed_test_cases[5].epoch_seed_hex);
//
//    int epoch = find_epoch_number(seed_29998);
//    EXPECT_EQ(epoch, 29998);
//
//    // The second call should be fast.
//    epoch = find_epoch_number(seed_29999);
//    EXPECT_EQ(epoch, 29999);

const hash256 seed_0 = to_hash256(epoch_seed_test_cases[0].epoch_seed_hex);
const hash256 seed_1 = to_hash256(epoch_seed_test_cases[1].epoch_seed_hex);
const hash256 seed_10 = to_hash256(epoch_seed_test_cases[3].epoch_seed_hex);
const hash256 seed_101 = to_hash256(epoch_seed_test_cases[5].epoch_seed_hex);
const hash256 seed_2047 = to_hash256(epoch_seed_test_cases[7].epoch_seed_hex);
const hash256 seed_10239 = to_hash256(epoch_seed_test_cases[10].epoch_seed_hex);

int epoch0 = find_epoch_number(seed_0);
EXPECT_EQ(epoch0, 0);

std::cout << to_hex(seed_0) << "\n";

int epoch1 = find_epoch_number(seed_1);
EXPECT_EQ(epoch1, 1);

std::cout << to_hex(seed_1) << "\n";

int epoch3 = find_epoch_number(seed_10);
EXPECT_EQ(epoch3, 10);
std::cout << to_hex(seed_10) << "\n";

int epoch = find_epoch_number(seed_101);
EXPECT_EQ(epoch, 101);

// The second call should be fast.
epoch = find_epoch_number(seed_2047);
EXPECT_EQ(epoch, 2047);

epoch = find_epoch_number(seed_10239);
EXPECT_EQ(epoch, 10239);
}

TEST(ethash, find_epoch_number_double_descending)
{
//    const hash256 seed_29998 = to_hash256(epoch_seed_test_cases[4].epoch_seed_hex);
//    const hash256 seed_29999 = to_hash256(epoch_seed_test_cases[5].epoch_seed_hex);
//
//    int epoch = find_epoch_number(seed_29999);
//    EXPECT_EQ(epoch, 29999);
//
//    // The second call should be fast.
//    epoch = find_epoch_number(seed_29998);
//    EXPECT_EQ(epoch, 29998);

const hash256 seed_101 = to_hash256(epoch_seed_test_cases[5].epoch_seed_hex);
const hash256 seed_2047 = to_hash256(epoch_seed_test_cases[7].epoch_seed_hex);
const hash256 seed_10239 = to_hash256(epoch_seed_test_cases[10].epoch_seed_hex);


int epoch = find_epoch_number(seed_10239);
EXPECT_EQ(epoch, 10239);

// The second call should be fast.
epoch = find_epoch_number(seed_2047);
EXPECT_EQ(epoch, 2047);


epoch = find_epoch_number(seed_101);
EXPECT_EQ(epoch, 101);
}

TEST(ethash, find_epoch_number_sequential)
{
//    hash256 seed = {};
const uint8_t* const ethashseedstr = reinterpret_cast<const uint8_t*>(ethash_seed_str);
ethash_hash256 seed = ethash_keccak256(ethashseedstr, strlen(ethash_seed_str));

    for (int i = 0; i <= max_epoch_number; ++i)
    {
        auto e = find_epoch_number(seed);
        EXPECT_EQ(e, i);
        seed = keccak256(seed);
    }
}

TEST(ethash, find_epoch_number_max)
{
//    const auto seed_max = to_hash256(epoch_seed_test_cases[7].epoch_seed_hex);
//    const auto seed_out_of_range = keccak256(seed_max);
//
//    find_epoch_number({});  // Reset cache.
//    EXPECT_EQ(find_epoch_number(seed_out_of_range), -1);
//    find_epoch_number({});  // Reset cache.
//    EXPECT_EQ(find_epoch_number(seed_max), max_epoch_number);

    const auto seed_max = to_hash256(epoch_seed_test_cases[11].epoch_seed_hex);
    const auto seed_out_of_range = keccak256(seed_max);

    find_epoch_number({});  // Reset cache.
    const uint8_t* const ethashseedstr = reinterpret_cast<const uint8_t*>(ethash_seed_str);
    ethash_hash256 seed = ethash_keccak256(ethashseedstr, strlen(ethash_seed_str));
    find_epoch_number(seed);
    EXPECT_EQ(find_epoch_number(seed_out_of_range), -1);

    find_epoch_number({});  // Reset cache.
    EXPECT_EQ(find_epoch_number(seed_max), max_epoch_number);
}

TEST(ethash, find_epoch_number_sequential_gap)
{
    constexpr int start_epoch = 200;
    hash256 seed = calculate_epoch_seed(start_epoch);
    for (int i = start_epoch; i <= max_epoch_number; ++i)
    {
        auto e = find_epoch_number(seed);
        EXPECT_EQ(e, i);
        seed = keccak256(seed);
    }
}

TEST(ethash, find_epoch_number_descending)
{
    for (int i = 2050; i >= 2000; --i)
    {
        auto seed = calculate_epoch_seed(i);
        auto e = find_epoch_number(seed);
        EXPECT_EQ(e, i);
    }

    for (int i = 50; i >= 0; --i)
    {
        auto seed = calculate_epoch_seed(i);
        auto e = find_epoch_number(seed);
        EXPECT_EQ(e, i);
    }
}

TEST(ethash, find_epoch_number_invalid)
{
    hash256 fake_seed = {};
    fake_seed.word32s[0] = 1;
    int epoch = find_epoch_number(fake_seed);
    EXPECT_EQ(epoch, -1);
}

TEST(ethash, find_epoch_number_epoch_too_high)
{
    hash256 seed = calculate_epoch_seed(max_epoch_number + 1);
    int epoch = find_epoch_number(seed);
    EXPECT_EQ(epoch, -1);
}

TEST(ethash_multithreaded, find_epoch_number_sequential)
{
    auto fn = [] {
        //hash256 seed = {};
        const uint8_t* const ethashseedstr = reinterpret_cast<const uint8_t*>(ethash_seed_str);
        ethash_hash256 seed = ethash_keccak256(ethashseedstr, strlen(ethash_seed_str));

        for (int i = 0; i <= max_epoch_number; ++i)
        {
            auto e = find_epoch_number(seed);
            EXPECT_EQ(e, i);
            seed = keccak256(seed);
        }
    };

    std::array<std::future<void>, 4> futures;
    for (auto& f : futures)
        f = std::async(std::launch::async, fn);
    for (auto& f : futures)
        f.wait();
}

TEST(ethash, get_epoch_number)
{
//    EXPECT_EQ(get_epoch_number(0), 0);
//    EXPECT_EQ(get_epoch_number(1), 0);
//    EXPECT_EQ(get_epoch_number(29999), 0);
//    EXPECT_EQ(get_epoch_number(30000), 1);
//    EXPECT_EQ(get_epoch_number(30001), 1);
//    EXPECT_EQ(get_epoch_number(30002), 1);
//    EXPECT_EQ(get_epoch_number(5000000), 166);
//    EXPECT_EQ(get_epoch_number(max_epoch_number * epoch_length), max_epoch_number);
//    constexpr auto max_block = max_epoch_number * epoch_length + epoch_length - 1;
//    EXPECT_EQ(get_epoch_number(max_block), max_epoch_number);

    EXPECT_EQ(get_epoch_number(56000), 0);
    EXPECT_EQ(get_epoch_number(56001), 0);
    EXPECT_EQ(get_epoch_number(59999), 0);
    EXPECT_EQ(get_epoch_number(60000), 1);
    EXPECT_EQ(get_epoch_number(60001), 1);
    EXPECT_EQ(get_epoch_number(60002), 1);
    EXPECT_EQ(get_epoch_number(3004000), 737);
    EXPECT_EQ(get_epoch_number(56000+max_epoch_number * epoch_length), max_epoch_number);
    constexpr auto max_block = 56000+max_epoch_number * epoch_length + epoch_length - 1;
    EXPECT_EQ(get_epoch_number(max_block), max_epoch_number);
}

//TEST(ethash, light_cache)
//{
//    struct light_cache_test_case
//    {
//        const int epoch_number;
//        const char* const hash;
//    };
//
//    light_cache_test_case test_cases[] = {
//        {0, "35ded12eecf2ce2e8da2e15c06d463aae9b84cb2530a00b932e4bbc484cde353"},
//        {171, "468ef97519bd780a0dbd19d46c099118d6f4b777c1b8d0d4b0d6f62a5018100e"},
//        {2047, "47e5913c1f0ffffa5ba1049f6d7960259a5e7e8736e3f032cc7a04e7b29ffb42"},
//    };
//
//    for (const auto& t : test_cases)
//    {
//        auto context = create_epoch_context(t.epoch_number);
//        const uint8_t* const light_cache_data = context->light_cache[0].bytes;
//        const size_t light_cache_size =
//            static_cast<size_t>(context->light_cache_num_items) * sizeof(context->light_cache[0]);
//        const hash256 light_cache_hash = keccak256(light_cache_data, light_cache_size);
//        EXPECT_EQ(light_cache_hash, to_hash256(t.hash));
//    }
//}

TEST(ethash, create_context_invalid_epoch)
{
    EXPECT_EQ(create_epoch_context(-1), nullptr);
    EXPECT_EQ(create_epoch_context(max_epoch_number + 1), nullptr);
}

//TEST(ethash, fake_dataset_partial_items)
//{
//    struct full_dataset_item_test_case
//    {
//        uint32_t index;
//        const char* hash_hex;
//    };
//
//    // clang-format off
//    full_dataset_item_test_case test_cases[] = {
//        {0,          "cc40bef17615acac264c8fedc4df8ca02b949f8cef3e3d08b6711acb8a5254941249cdf50be5fccf0082e587f5520546db85250d853e98ee01fedb87252222c5"},
//        {1,          "03489165b412bfe8085f73902383ae2fff5aa2882835f5f4dc68826f3c52172b98dfb0a94bacde60634d5aaa0b89ef2e7ac0fe024d4bf2ef9d3ff2569aeb1aa3"},
//        {13,         "f90b200ec5dc92625fca180f97667aff09f93194b7c5f17fcb08ae7fc97198f24dd6f2c8d72ac76ffe435f506368978a8a784a4d89cad374ec58ce13a0e67689"},
//        {171,        "0e538e98a6a0c2c114560777cfb48814bb8b5c314ed03d0c60367588daea53c6d87184f72fbc951c57305b67d766f2361220a6a4907018bd3bc70f69f8bcf87c"},
//        {571,        "1cb34c582cc4a2ea96473349670703675ac6e4a6cfd5777ad5f496df1467456635227532821d5e07fb288a30180c5c483457ca57ffb3b1f3ddcbc4113bcc38cb"},
//        {620,        "05c230cf73242696b4810ff5ddd522d07b63c83e54eb0da17b691f79db5247c9bac577b8af56462d86bbbff7a767634483b697c93d98c4950e2a856ef673b6fa"},
//        {514079,     "949b9be7de5b3c009f5d8185b511bd3ddf29dfbf453905c91083cbfc01098455ad73d41a3b4af742509e3ae6cad96024b8ac5337a9c2f1a418c3875537b390a4"},
//        {852881,     "e67f0331c7bd43d215988c862bfac14424e0d56fd6603cc281691f5ae229b6652b0adb311dc5dbdc124d66f90e699c16ed1c0f04efa03f9fd14888c42d841585"},
//        {6133492,    "94b4c2bb240f039943d5612243be303d87c523ee2c319cd094960671716403dd2735cd7305a13d4b85d12e75997b2f6dfeaf77fcee0dd3e2c7b72135ca585bc9"},
//        {6133493,    "aed4fd3f4d641fb3ad4cc5d8602a6c4b7b40ee2ca6cb694a679662992c744603e97a7dfc1b6ed94820556d9a7bfca3afb91175ab55837cad31a508dd8084100d"},
//        {211322105,  "51c99716a2193f38f42c49c96e915db7a304c1d0ee9458e207d221c4ec287fc01a692d99433ea5fa99b3c9a71d899bb4bc88bcddbb9da1c1f3cbb62738c0a4b0"},
//        {740620450,  "aa6a733cff55c9d1cc9058a1cd919076fe06cc9dea4f2db9aa17414dc60cc80087637f8536894335532b019da8066ac28ab76cfcd9236924e19328c777fa11be"},
//        {4294967295, "8e4fdb5dc602598f10a42b5061132eec05299380db872a3caf04aa21e3d4970350394dfbd58c5ab54571b1be0cc9001d788c6b14cbf003d7decc2aaef1232b8c"},
//    };
//    // clang-format on
//
//    // Mock the epoch context.
//    auto context = create_epoch_context_mock(0);
//
//    for (const auto& t : test_cases)
//    {
//        const auto full_index = t.index / 2;
//        const auto part_index = t.index % 2;
//
//        const auto full_item = calculate_dataset_item_1024(*context, full_index);
//        const auto& part_item = full_item.hash512s[part_index];
//        EXPECT_EQ(to_hex(part_item), t.hash_hex) << "index: " << t.index;
//    }
//}
//
//TEST(ethash, fake_dataset_items)
//{
//    struct full_dataset_item_test_case
//    {
//        uint32_t index;
//        const char* hash1_hex;
//        const char* hash2_hex;
//    };
//
//    // clang-format off
//    full_dataset_item_test_case test_cases[] = {
//        {0,
//            "cc40bef17615acac264c8fedc4df8ca02b949f8cef3e3d08b6711acb8a5254941249cdf50be5fccf0082e587f5520546db85250d853e98ee01fedb87252222c5",
//            "03489165b412bfe8085f73902383ae2fff5aa2882835f5f4dc68826f3c52172b98dfb0a94bacde60634d5aaa0b89ef2e7ac0fe024d4bf2ef9d3ff2569aeb1aa3"},
//        {1,
//            "9d05d44ed96bcaef3c94806b360a828ae04e78208cd496ffeaa72bc2ffd0932daf92ffae790030474e8382a5d527c97696edafa58536b0ab86f5401cf8b34e5c",
//            "88202c073303c41d7df6d03ec001a53a3d13f86e9265190b46d3c6587fab9e2773265f7165b131347a28346f2c74e3240cb46967626eb2aa22df61b9608ba66b"},
//        {13,
//            "02e5420afa905efcf10f46e61f5dddb19f47aca443fba979ded7310e1ac467dd11e5862f3cb474b78591d145cb6dabe302e87625d6e61d5e5b97962fabb2435e",
//            "eba863b9003b8b805504bf8dd0f9fcd9950206d7a866a0eeb089130b84c36b803fe57eecafc25251ed3e68c57862298c988dbede2656ca6a82cbbbf0c9aefb3c"},
//        {171,
//            "23837067d9ae9a5f4dbe5c30ad86e28379a73276000d23fb096cb4a6bb406b3e5d7639e7c9650ee3814dec0d6a7d1b51ce10b41e2ddb9f8ea7fa2e6ac73320b1",
//            "cdba9bccd4cb9bf7ecd48eb6ff3ae288cb56be91d25b8bb3b6681a93cc6ea254bc24ed0b1235fcbde16356ba2dc193ee8103d9dca681cf1aa4014911a71ac452"},
//        {571,
//            "922e3fc9b1741567df72b68531345e7f37c9ec64885101e587035ff5968db7163fc3d66851aa459911d432779acab42ca65c233d4d193e0fb39aedca1b8f7631",
//            "9fa4cbdcb6b208f5cc86328a60657fb3818dab7fd496d5494ebda842902f251bce587a38928e5450d899899e769280df001a3bfc20b04a0ade4c6f6d82c8c174"},
//        {620,
//            "601668d81c7f8b0268d404f96528fa4d29226c3c84c4520f0d234d21e83be004571a8839826e102b4ef6c090480ef35a85f45700e5d2efbbb4c1721a797b2a39",
//            "437fae4b69f3c25224c115cd74d600f008c3668c2815d27d2afb564d941412d0381ff7320ccc97c37238b6ebc54bf907dfccc6cf9ad8d9ca8662bda15c15f64b"},
//        {514079,
//            "259bc18e5cb2a4e5897c106fb9f3fe1480f8b48b86077673e3e9affa24f8ca5d3e307370ae56534aa8ebd88ade50aef7f9e941c173d18d189fc528bd5f6141b9",
//            "6918d14a2fa8f7b0cf54297b949301770743b00a359ef428174dc8d2b8dc686fddfa79cd3bd9e46654d3848a37f9fe733e95b708132db1764eaa3b39db703040"},
//        {852881,
//            "95080490fe6781eda38979e23baba0915c7a4d441bd2a790fa930139ad99865ca890a06623b9ddfaaacc1fc17420b8d443ca53b89c4a3716aa5d6d088ca89a27",
//            "5e639f40eb575f2677e1141a99e3bec90121067ffb7ed8340bdc889d8d128ea78414dc56f5148229d9fc1d5517352b6f96afd5d3a655095a05b85ce157bebd31"},
//        {6133492,
//            "cd7482a6294a547e770f02dd73c76a6606370cd1177b773aa1cd66868a76f3a817e0c39c76f54d8894ec7b5ebddf8606a0b20249f93d1e3defa325ba81aa4cd8",
//            "c4a4dfcc85f6ef120871ab28e676806e6f080a0dd897fc648fb9dfd9df7fcae91e20c7f6d4ea161e15ec27542005dfc4293acab0365c98fec1f104b47b09f47f"},
//        {6133493,
//            "1a7d2bdfb9f60d83d86dc5404e1115ddee6029fbc48d854afbc18bedadeb6951d81391615d5d73d96e431f492dd66c5de56d4f71ca80915283170dcf9401d75b",
//            "be530488cce0d1b7c1eca2361e43426960e413a93649aeec5dd74562da06cb1399e685c00705bea21f2ba4369b0fbcd0404052e4ea27aeab00f03343a38ab15c"},
//        {211322105,
//            "b7f04034d7a5ceb52074327a241b708ced97910b5a0f2b8e56464603ce678498659cf0db3866d39bbf8924d3efb5b23e4c2f5be6ff4b096a67f213e87137235f",
//            "67ecd7b90665ad13c8de3092e798984413aac3bd37ab9f5a6583e341a7d2888679131f1afff253a6e0c524b2ec6dae8a0e607ea137e854e9ed2bb1ca572dd6aa"},
//        {740620450,
//            "7e4a3533ef6f0d9fa7e41b8304e08fe9e52556334cad0cc861337bd1155bbea211cf0b0198b4f08567cc47fcc964bbbdfb2f851437da1edba7c6f4bd3fd61a3a",
//            "f20969bd0407bb76560e7c099224a1ea185214808950519fafdcd02ba2874e9b4ebf1797cafb3b80e903b13a87ddac5d54d67ed58acf49bb12e03b81eb6c99af"},
//        {2147418082,  // Max index for epoch 32639.
//            "a79eaa61a5c2256eb3bf9c78a2b6509929780d8826d7a7d1324328ab786ca9c23fc1437e1efb432ab823c5d5448b4183893d16168aebe21470e3515104eab67f",
//            "496baeac6ea83fdd5a6a20827029ddd73d1be507dc7f210c2aed29f0757eefea72ab7e4c92aab9ee34ed46027bdc9918e047b0f845c7fbbd254b8014141c7605"},
//        {0x7fffffff,  // Max allowed index value.
//            "21471504c1f31007c14acd107a8ade1aad6c2a6c2ad879b3aca3b12517105483502d0e3e902acf3b128d294c0a69f2cc199bf8813be1f8bb4b5625822b70ec09",
//            "8e4fdb5dc602598f10a42b5061132eec05299380db872a3caf04aa21e3d4970350394dfbd58c5ab54571b1be0cc9001d788c6b14cbf003d7decc2aaef1232b8c"},
//    };
//    // clang-format on
//
//    // Mock the epoch context.
//    auto context = create_epoch_context_mock(0);
//
//    for (const auto& t : test_cases)
//    {
//        const hash1024 item1024 = calculate_dataset_item_1024(*context, t.index);
//        EXPECT_EQ(to_hex(item1024.hash512s[0]), t.hash1_hex) << "index: " << t.index;
//        EXPECT_EQ(to_hex(item1024.hash512s[1]), t.hash2_hex) << "index: " << t.index;
//    }
//}
//
//
//TEST(ethash, dataset_items_epoch13)
//{
//    struct full_dataset_item_test_case
//    {
//        uint32_t index;
//        const char* hash1_hex;
//        const char* hash2_hex;
//    };
//
//    // clang-format off
//    full_dataset_item_test_case test_cases[] = {
//        {0,
//            "6526a7e7ab092dfd21ebe6ffa1225370886a9a9fc828f929775de6a2737a3b9d1bb728bd23a61478e9fbf837d317829292d469cbb1a90a29058c0f604aeee5a6",
//            "a2fe2a6253d8642b5dcc6a211b7f4d6ee9b60ac235ee2c9d64a064ea20e47fe4cdad99aa9c7dd5e2d71e58b7957ff91062d1f1c014cd4453db2ddb094056529b"},
//        {1,
//            "7a03a5f8e028db852542ce2f10d25b7dcdf9a25c3898aabe78b881ef58e56ffaedb24c870184a6f0513a65f09066e9f9224baf6f684e0c54e7ef400004ec9fb8",
//            "639f251bbee0b1114e687ea651717eb69c0b76bc673dd4c9d697f41c307d66bdbe92b26df3dda209f25d6784c7a1db5902c18323285255684359728f5ca6da31"},
//        {13,
//            "63886d5b8967584addad94d45d194209bdf05e34b11894575ad292bf6da94117224b6e0d7b57791438ff701d3a0d2a80f261cc2ebde97e3bfc8574bb3519593c",
//            "afec130195473d4389d0ea13ec33ba8048a4075043fd2f2bc502f534f4f600ddb3417e53a9f23918c5e134049ed2b8561f1165d8543852f7e9792fa6332c268c"},
//        {171,
//            "a3dabfb475532cbc59d8b6732e73f108bba7b325b90e32690f00ea08f8977a94774106b08314763d403b153bc27fb58d5b2b84955e3069e2e6e63718bc2d3a26",
//            "056c1c4861d530aa6aa962cfd8256828661c93a3985d4dfa88011b496e94b031e86650183c706488984d0d0302ed79d5c1ac977dc6881006cb2b0b6b76542067"},
//        {571,
//            "14276428b23db295620e56dc2212c4f75f4dc20545ad0d2fe5f08e7c99b5fb372bb342f098525e30ff49f2b66891d9973101c8b4579269311afbc6c0a8822bbd",
//            "1ed369ce428c0c768c9fcc45089e830e603baa3b6fb81f60ef4b652ac19ab90ce3b3b007fb5fc289bc822e82e3b6b9aaef51258cd6bfecf23c30ed576a246d6a"},
//        {620,
//            "d3df66afb0b84a35b6ddb32d1b04a30c814cad357c0e46bffa2f6cbf0d95c76eef10b3b59fdce344924981cfdacdf93accecfa6ffe8b5041640e83feccb26a9c",
//            "fb97636b8e8b9bb593ab2d0235bc803608901cb3484e277761d376baf03d6986caf24f00a37a5a970a5b0de551cc27d45b9bf6ce3986b18cd78d98c028e956b1"},
//        {514079,
//            "279fe53aec52daf6341580b4c43841b39157b66144733ddaa3b11886a9bc3a61892af817e0f1ff9ac374351aa7cc16f7ac55bbc0cd53aaa72747db9fe07d9938",
//            "793b56c9baafe3638d9b3bfdf09f136d9b01bf206919df571e3e6de7320822f6d1567c69240b28181d797d0ab53b342f17dcb9746bdc0afb75fd115e7aa244ec"},
//        {852881,
//            "9f877290e5ba25760b6719e12c06e7e8e36b5d2510354ec3e269e04c36146bd8c7f5a1aa4df47c7a0f1f139bdfb5a1a7108b7eadd41d7acb40532c4cff1619d1",
//            "a0b6e119086c1f26aa578c678374e59b49388941fe9a119d00a7c82214702d5626b810df756fb399a5cf54cb09ce6aa25ed99ebe3bcc92178c9180cf956189a5"},
//        {6133492,
//            "539f72291dd31e5234081057904daff0329bf0099726c20fa1f1b31377ac84acc60d64c29206ccc0191a5f797293c151f0d506fa2ef5daf70654654c349fbf70",
//            "764e27dd47579073a74f92ef843a11219629583ab6b9b4907dcededbacbea1ed8b3f7a36336dc9a39839faf4d5095e50d9632e9e23819d7f85daa0f87a6a2efa"},
//        {6133493,
//            "379a030e94c3718a7220dcc9865e600eea2bb049aa251e26d812c952fa9bedecfc2e9a04d421810d5ef2500e9d5a4a44d8d6e731414a7bd94268333f23368c59",
//            "609f6d9d852794d11cf748bdb1784662ee0080fed4c18683a74ef4fdb3a5c243c9b3981b87fe912ac8860ff1a021e115dae2c96f14de6387c802c9910290ead3"},
//        {211322105,
//            "b3bb7286d9840720319aa6dd4bc7f8b55cc38b1ff0151c4a46ffb4b2a99c6eeb966bde5efc7f3f0c3a753c338238e37e119b75e6c553f2aab575238e1ba07880",
//            "0b89a30d5ed6bf1959c6e4d265ddf941bed6ce579493726c7d98de68267bb0eccfb0dbdf7a2d0d45d900d7588995212a8618ea679ab08425922b5042a0fdb95c"},
//        {740620450,
//            "df0c2e2f4df033a64b1bcd207c30c7ce48c7d8ca8edd1284c87a91d54372ed0cb513d1876b1dbef6fc06c496941039cba6c50676596d6379152689d9841c97e4",
//            "357bacef5baf4687c87e7ff07d5ab104ce39badcf9633c22ee31c3c3de0887b296f9385ea27573cb94bc3423cc39ab2a733be97a98e860290c31e94f03f39814"},
//        {2147418082,  // Max index for epoch 32639.
//            "9705a12d9f1a193ffea9b9c6603b8d17315896b84ea6649e613fec1578c867535e6bbfd71cb18ce0c0dd6ca8051f7bfb5cfa2d89b29d1bf25a0b36ae57505844",
//            "c2f3475bf52ec727a0b684d9fbc5ce9234331abc585c383e87fa70e8c860819b35c12e6173df081f3f84bea218633ad54c9da6051ba90efc3985e887530cb89e"},
//        {0x7fffffff,  // Max allowed index value.
//            "d463d63e393e6ccc31b240d3d12301a14e0410377657b0554d6041541303c2ddc8ec026432adf73311b56de486f6fdca808f87f3824587b413a4e4f7a571d046",
//            "9e15d844f137ae66e7fc23934cc51d53a36ec28a5d1a246d50773471252ae9ea30fe20e817434e771bbf77577899cf2cce8de11578b925a12af2ad9dd316f0ec"},
//    };
//    // clang-format on
//
//
//    // Create example epoch context.
//    const auto context = create_epoch_context(13);
//
//    for (const auto& t : test_cases)
//    {
//        const hash1024 item = calculate_dataset_item_1024(*context, t.index);
//        EXPECT_EQ(to_hex(item.hash512s[0]), t.hash1_hex) << "index: " << t.index;
//        EXPECT_EQ(to_hex(item.hash512s[1]), t.hash2_hex) << "index: " << t.index;
//    }
//}

TEST(ethash, verify_hash_light)
{
    // const hash256 zero{};
    // const hash256 one = inc(zero);

    epoch_context_ptr context{nullptr, ethash_destroy_epoch_context};

    for (const auto& t : hash_test_cases)
    {
        // const int epoch_number = t.block_number / epoch_length;
        const int epoch_number = (t.block_number -block_height_start) / epoch_length;
        const uint64_t nonce = std::stoull(t.nonce_hex, nullptr, 16);
        const hash256 header_hash = to_hash256(t.header_hash_hex);
        const hash256 mix_hash = to_hash256(t.mix_hash_hex);
        const hash256 boundary = to_hash256(t.final_hash_hex);
        const hash256 difficulty = ethash_difficulty_to_boundary(&boundary);

        if (!context || context->epoch_number != epoch_number)
            context = create_epoch_context(epoch_number);

        result r = hash(*context, header_hash, nonce);
        EXPECT_EQ(to_hex(r.final_hash), t.final_hash_hex);
        EXPECT_EQ(to_hex(r.mix_hash), t.mix_hash_hex);

//        auto ec = verify_final_hash_against_difficulty(header_hash, mix_hash, nonce, difficulty);
//        EXPECT_EQ(ec, ETHASH_SUCCESS);
//        EXPECT_FALSE(ec);
//        EXPECT_EQ(ec.category(), ethash_category());
//
//        ec = verify_final_hash_against_difficulty(header_hash, mix_hash, nonce, inc(difficulty));
//        EXPECT_EQ(ec, ETHASH_INVALID_FINAL_HASH);
//
//        ec = verify_against_boundary(*context, header_hash, mix_hash, nonce, boundary);
//        EXPECT_EQ(ec, ETHASH_SUCCESS);
//
//        ec = verify_against_boundary(*context, header_hash, mix_hash, nonce, dec(boundary));
//        EXPECT_EQ(ec, ETHASH_INVALID_FINAL_HASH);
//
//        ec = verify_against_boundary(*context, header_hash, mix_hash, nonce, inc(boundary));
//        EXPECT_EQ(ec, ETHASH_SUCCESS);
//
//        ec = verify_against_difficulty(*context, header_hash, mix_hash, nonce, difficulty);
//        EXPECT_EQ(ec, ETHASH_SUCCESS);
//
//        ec = verify_against_difficulty(*context, header_hash, mix_hash, nonce, dec(difficulty));
//        EXPECT_EQ(ec, ETHASH_SUCCESS);
//
//        ec = verify_against_difficulty(*context, header_hash, mix_hash, nonce, inc(difficulty));
//        EXPECT_EQ(ec, ETHASH_INVALID_FINAL_HASH);
//
//        ec = verify_against_difficulty(*context, header_hash, mix_hash, nonce, zero);
//        EXPECT_EQ(ec, ETHASH_SUCCESS);
//
//        ec = verify_against_difficulty(*context, header_hash, mix_hash, nonce, one);
//        EXPECT_EQ(ec, ETHASH_SUCCESS);
//
//        const bool within_significant_boundary = r.final_hash.bytes[0] == 0;
//        if (within_significant_boundary)
//        {
//            ec = verify_final_hash_against_difficulty(header_hash, mix_hash, nonce + 1, difficulty);
//            EXPECT_EQ(ec, ETHASH_INVALID_FINAL_HASH);
//
//            ec = verify_against_boundary(*context, header_hash, mix_hash, nonce + 1, boundary);
//            EXPECT_EQ(ec, ETHASH_INVALID_FINAL_HASH);
//
//            ec = verify_against_difficulty(*context, header_hash, mix_hash, nonce + 1, difficulty);
//            EXPECT_EQ(ec, ETHASH_INVALID_FINAL_HASH);
//        }
//        else
//        {
//            ec = verify_against_boundary(*context, header_hash, mix_hash, nonce + 1, boundary);
//            EXPECT_EQ(ec, ETHASH_INVALID_MIX_HASH);
//
//            ec = verify_against_difficulty(*context, header_hash, mix_hash, nonce + 1, difficulty);
//            EXPECT_EQ(ec, ETHASH_INVALID_MIX_HASH);
//        }
    }
}

TEST(ethash, verify_hash)
{
    epoch_context_full_ptr context{nullptr, ethash_destroy_epoch_context_full};

    for (const auto& t : hash_test_cases)
    {
        //const int epoch_number = t.block_number / epoch_length;
        const int epoch_number = (t.block_number-block_height_start) / epoch_length;
        const uint64_t nonce = std::stoull(t.nonce_hex, nullptr, 16);
        const hash256 header_hash = to_hash256(t.header_hash_hex);

        const int full_dataset_num_items = calculate_full_dataset_num_items(epoch_number);
        const uint64_t full_dataset_size = get_full_dataset_size(full_dataset_num_items);

        if (!context || context->epoch_number != epoch_number)
            context = create_epoch_context_full(epoch_number);

        if (sizeof(void*) == 4)
        {
            // On 32-bit systems expect failures for allocations > 1GB of memory.
            static constexpr auto allocation_size_limit = uint64_t{1} * 1024 * 1024 * 1024;
            if (!context && full_dataset_size > allocation_size_limit)
                continue;
        }

        ASSERT_NE(context, nullptr) << full_dataset_size;
        EXPECT_GT(full_dataset_size, 0);

        result r = hash(*context, header_hash, nonce);
        EXPECT_EQ(to_hex(r.final_hash), t.final_hash_hex);
        EXPECT_EQ(to_hex(r.mix_hash), t.mix_hash_hex);
    }
}

//TEST(ethash, verify_final_hash_only)
//{
//    auto& context = get_ethash_epoch_context_0();
//    const hash256 header_hash = {};
//    const hash256 mix_hash = {};
//    uint64_t nonce = 3221208;
//    const hash256 difficulty =
//        to_hash256("00000000000000000000000000000000000000000000000000000000012853fe");
//
//    EXPECT_EQ(verify_final_hash_against_difficulty(header_hash, mix_hash, nonce, difficulty),
//        ETHASH_SUCCESS);
//    EXPECT_EQ(verify_against_difficulty(context, header_hash, mix_hash, nonce, difficulty),
//        ETHASH_INVALID_MIX_HASH);
//}
//
//TEST(ethash, verify_boundary)
//{
//    const auto& context = get_ethash_epoch_context_0();
//    const hash256 example_header_hash =
//        to_hash256("e74e5e8688d3c6f17885fa5e64eb6718046b57895a2a24c593593070ab71f5fd");
//    const uint64_t nonce = 6666;
//    const auto r = hash(context, example_header_hash, nonce);
//    const auto boundary_eq =
//        to_hash256("13c5a668bba6b86ed16098113d9d6a7a5cac1802e9c8f2d57c932d8818375eb7");
//
//    const auto boundary_gt = inc(boundary_eq);
//    EXPECT_EQ(
//        to_hex(boundary_gt), "13c5a668bba6b86ed16098113d9d6a7a5cac1802e9c8f2d57c932d8818375eb8");
//
//    const auto boundary_lt = dec(boundary_eq);
//    EXPECT_EQ(
//        to_hex(boundary_lt), "13c5a668bba6b86ed16098113d9d6a7a5cac1802e9c8f2d57c932d8818375eb6");
//
//    EXPECT_EQ(r.final_hash, boundary_eq);
//    EXPECT_EQ(to_hex(r.final_hash), to_hex(boundary_eq));
//
//    EXPECT_EQ(verify_against_boundary(context, example_header_hash, r.mix_hash, nonce, boundary_eq),
//        ETHASH_SUCCESS);
//    EXPECT_EQ(verify_against_boundary(context, example_header_hash, r.mix_hash, nonce, boundary_gt),
//        ETHASH_SUCCESS);
//    EXPECT_EQ(verify_against_boundary(context, example_header_hash, r.mix_hash, nonce, boundary_lt),
//        ETHASH_INVALID_FINAL_HASH);
//}
//
//TEST(ethash_multithreaded, small_dataset)
//{
//    // This test creates a tiny dataset for full search to discover sync issues between threads.
//
//    constexpr size_t num_treads = 8;
//    constexpr int num_dataset_items = 501;
//    const hash256 boundary =
//        to_hash256("0004000000000000000000000000000000000000000000000000000000000000");
//
//    auto context = create_epoch_context_mock(0);
//    const_cast<int&>(context->full_dataset_num_items) = num_dataset_items;
//
//    std::unique_ptr<hash1024[]> full_dataset{new hash1024[num_dataset_items]{}};
//    reinterpret_cast<test_context_full*>(context.get())->full_dataset = full_dataset.get();
//    auto context_full = reinterpret_cast<epoch_context_full*>(context.get());
//
//    std::array<std::future<search_result>, num_treads> futures;
//    for (auto& f : futures)
//    {
//        f = std::async(
//            std::launch::async, [&] { return search(*context_full, {}, boundary, 30000, 10000); });
//    }
//
//    for (auto& f : futures)
//        EXPECT_EQ(f.get().nonce, 38444);
//}
//
//TEST(ethash, small_dataset)
//{
//    constexpr int num_dataset_items = 501;
//    const hash256 boundary =
//        to_hash256("0080000000000000000000000000000000000000000000000000000000000000");
//
//    auto context = create_epoch_context_mock(0);
//    const_cast<int&>(context->full_dataset_num_items) = num_dataset_items;
//
//    std::unique_ptr<hash1024[]> full_dataset{new hash1024[num_dataset_items]{}};
//    reinterpret_cast<test_context_full*>(context.get())->full_dataset = full_dataset.get();
//    auto context_full = reinterpret_cast<epoch_context_full*>(context.get());
//
//    auto solution = search_light(*context, {}, boundary, 940, 10);
//    EXPECT_TRUE(solution.solution_found);
//    EXPECT_EQ(solution.nonce, 948);
//    const auto final_hash_hex = "004b92ceeb2045f9745917e4d9868a0db16b06d60ee1d8d33b9ff859053f4bb8";
//    EXPECT_EQ(to_hex(solution.final_hash), final_hash_hex);
//    const auto mix_hash_hex = "a5a4f053b8424f1c0a4403898d106f0488c8a819334c542ac4fabc0d2cbd7f26";
//    EXPECT_EQ(to_hex(solution.mix_hash), mix_hash_hex);
//
//    solution = search(*context_full, {}, boundary, 940, 10);
//    EXPECT_TRUE(solution.solution_found);
//    EXPECT_EQ(solution.nonce, 948);
//    EXPECT_EQ(to_hex(solution.final_hash), final_hash_hex);
//    EXPECT_EQ(to_hex(solution.mix_hash), mix_hash_hex);
//
//    solution = search_light(*context, {}, boundary, 483, 10);
//    EXPECT_FALSE(solution.solution_found);
//    EXPECT_EQ(solution.final_hash, hash256{});
//    EXPECT_EQ(solution.mix_hash, hash256{});
//    EXPECT_EQ(solution.nonce, 0);
//
//    solution = search(*context_full, {}, boundary, 483, 10);
//    EXPECT_FALSE(solution.solution_found);
//    EXPECT_EQ(solution.final_hash, hash256{});
//    EXPECT_EQ(solution.mix_hash, hash256{});
//    EXPECT_EQ(solution.nonce, 0);
//}

#ifndef __APPLE__

// The Out-Of-Memory tests try to allocate huge memory buffers. This fails on
// Linux and Windows, but not on macOS. Because the macOS tries too hard
// the tests go forever.
// The tests are disabled on macOS at compile time (instead of using GTest
// filter) because we don't want developers using macOS to be hit by this
// behavior.

#ifdef __linux__
#include <sys/resource.h>

namespace
{
rlimit orig_limit;

bool set_memory_limit(size_t size)
{
    getrlimit(RLIMIT_AS, &orig_limit);
    rlimit limit = orig_limit;
    limit.rlim_cur = size;
    return setrlimit(RLIMIT_AS, &limit) == 0;
}

bool restore_memory_limit()
{
    return setrlimit(RLIMIT_AS, &orig_limit) == 0;
}
}  // namespace

#else

namespace
{
bool set_memory_limit(size_t)
{
    return true;
}

bool restore_memory_limit()
{
    return true;
}
}  // namespace

#endif

static constexpr bool arch64bit = sizeof(void*) == 8;

TEST(ethash, create_context_oom)
{
    static constexpr int epoch = arch64bit ? 3000 : 300;
    static constexpr size_t expected_size = arch64bit ? 26239565696 : 3590324096;
    const int num_items = calculate_full_dataset_num_items(epoch);
    const uint64_t full_dataset_size = get_full_dataset_size(num_items);
    const size_t size = static_cast<size_t>(full_dataset_size);
    ASSERT_EQ(size, full_dataset_size);
    ASSERT_EQ(size, expected_size);

    ASSERT_TRUE(set_memory_limit(1024 * 1024 * 1024));
    auto* context = ethash_create_epoch_context_full(epoch);
    ASSERT_TRUE(restore_memory_limit());
    EXPECT_EQ(context, nullptr);
}
#endif

namespace
{
struct less_equal_test_case
{
    const char* a_hex;
    const char* b_hex;
    bool expected_result;
};

less_equal_test_case less_equal_test_cases[] = {
    {"0000000000000000000000000000000000000000000000000000000000000000",
        "0000000000000000000000000000000000000000000000000000000000000000", true},
    {"0000000000000000000000000000000000000000000000000000000000000001",
        "0000000000000000000000000000000000000000000000000000000000000000", false},
    {"0000000000000000000000000000000000000000000000000000000000000000",
        "0000000000000000000000000000000000000000000000000000000000000001", true},
    {"0000000000000000000000000000000000000000000000000000000000000001",
        "0000000000000000000000000000000000000000000000000000000000000100", true},
    {"1000000000000000000000000000000000000000000000000000000000000000",
        "0000000000000000000000000000000000000000000000000000000000000001", false},
    {"1000000000000000000000000000000000000000000000000000000000000000",
        "0010000000000000000000000000000000000000000000000000000000000000", false},
    {"0000000000000000000000000010000000000000000000000000000000000000",
        "0000000000000000000000000001000000000000000000000000000000000000", false},
    {"0000000000000000000000000010000000000000000000000000000000000000",
        "0000000000000000000000000010000000000000000000000000000000000000", true},
    {"1000000000000000000000000000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000000000000000000000000000002", true},
    {"2000000000000000000000000000000000000000000000000000000000000001",
        "1000000000000000000000000000000000000000000000000000000000000002", false},
    {"1000000000000000000000000000000000000000000000000000000000000000",
        "2000000000000000000000000000000000000000000000000000000000000000", true},
    {"1000000000000000200000000000000000000000000000000000000000000000",
        "2000000000000000100000000000000000000000000000000000000000000000", true},
    {"aaaaaaaaaaaaaaaa100000000000000000000000000000000000000000000000",
        "aaaaaaaaaaaaaaaa100000000000000000000000000000000000000000000000", true},
    {"aaaaaaaaaaaaaaaa100000000000000000000000000000000000000000000000",
        "aaaaaaaaaaaaaaaa200000000000000000000000000000000000000000000000", true},
    {"aaaaaaaaaaaaaaaa200000000000000000000000000000000000000000000000",
        "aaaaaaaaaaaaaaaa100000000000000000000000000000000000000000000000", false},
    {"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa10000000000000000000000000000000",
        "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa10000000000000000000000000000000", true},
    {"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa10000000000000000000000000000000",
        "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa20000000000000000000000000000000", true},
    {"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa20000000000000000000000000000000",
        "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa10000000000000000000000000000000", false},
    {"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa1000000000000000",
        "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa1000000000000000", true},
    {"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa1000000000000000",
        "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa2000000000000000", true},
    {"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa2000000000000000",
        "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa1000000000000000", false},
};
}  // namespace

TEST(ethash, less_equal)
{
    for (const auto& t : less_equal_test_cases)
    {
        auto a = to_hash256(t.a_hex);
        auto b = to_hash256(t.b_hex);
        EXPECT_EQ(less_equal(a, b), t.expected_result);
    }
}

TEST(ethash, inc)
{
    const auto t = [](const char* s) { return to_hex(inc(to_hash256(s))); };

    EXPECT_EQ(t("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),
        "0000000000000000000000000000000000000000000000000000000000000000");
    EXPECT_EQ(t("0000000000000000000000000000000000000000000000000000000000000000"),
        "0000000000000000000000000000000000000000000000000000000000000001");
    EXPECT_EQ(t("000000000000000000000000000000000000000000000000ffffffffffffffff"),
        "0000000000000000000000000000000000000000000000010000000000000000");
    EXPECT_EQ(t("00000000000000000000000000000000ffffffffffffffffffffffffffffffff"),
        "0000000000000000000000000000000100000000000000000000000000000000");
    EXPECT_EQ(t("0000000000000000ffffffffffffffffffffffffffffffffffffffffffffffff"),
        "0000000000000001000000000000000000000000000000000000000000000000");
    EXPECT_EQ(t("0fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),
        "1000000000000000000000000000000000000000000000000000000000000000");
    EXPECT_EQ(t("fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe"),
        "ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");
}

TEST(ethash, dec)
{
    const auto t = [](const char* s) { return to_hex(dec(to_hash256(s))); };

    EXPECT_EQ(t("0000000000000000000000000000000000000000000000000000000000000000"),
        "ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");
    EXPECT_EQ(t("0000000000000000000000000000000000000000000000000000000000000001"),
        "0000000000000000000000000000000000000000000000000000000000000000");
    EXPECT_EQ(t("0000000000000000000000000000000000000000000000010000000000000000"),
        "000000000000000000000000000000000000000000000000ffffffffffffffff");
    EXPECT_EQ(t("0000000000000000000000000000000100000000000000000000000000000000"),
        "00000000000000000000000000000000ffffffffffffffffffffffffffffffff");
    EXPECT_EQ(t("0000000000000001000000000000000000000000000000000000000000000000"),
        "0000000000000000ffffffffffffffffffffffffffffffffffffffffffffffff");
    EXPECT_EQ(t("1000000000000000000000000000000000000000000000000000000000000000"),
        "0fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");
    EXPECT_EQ(t("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),
        "fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe");
}
